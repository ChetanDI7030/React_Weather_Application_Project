"use strict";(self.webpackChunkweather_app=self.webpackChunkweather_app||[]).push([[1448],{71448:(e,t,r)=>{r.d(t,{J:()=>ee});var i=r(35143),n=(r(63844),r(14873),r(47662),r(72690),r(86946),r(71832),r(5766)),s=(r(35039),r(86616)),o=r(76460),l=r(68134),a=r(46053),u=r(81806),p=(r(47249),r(85842)),d=r(42553),c=r(53084),f=r(69098);let y=class extends((0,f.O)(d.oY)){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],y.prototype,"expression",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],y.prototype,"title",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],y.prototype,"returnType",void 0),y=(0,i._)([(0,p.$)("esri.layers.support.ExpressionInfo")],y);const v=y;var b;let m=b=class extends d.oY{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new b({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:(0,c.o8)(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"isAutoGenerated",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"alias",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"onStatisticField",void 0),(0,i._)([(0,a.MZ)({type:v,json:{write:!0}})],m.prototype,"onStatisticExpression",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"statisticType",void 0),m=b=(0,i._)([(0,p.$)("esri.layers.support.AggregateField")],m);const h=m;var w,g=r(80979),_=r(80524),x=r(16868),M=r(31382),S=r(48611),E=r(6409),I=r(28379),F=r(17707),R=r(55053),A=r(46326),V=r(71401);let Z=w=class extends _.c{constructor(e){super(e),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(e,t,r){const i=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,S.sM)(r,i,t)}readRenderer(e,t,r){var i,n;const o=null===(i=t.drawingInfo)||void 0===i?void 0:i.renderer;return o?null!==(n=(0,s.L)(o,t,r))&&void 0!==n?n:void 0:(0,A.PD)(t,r)}clone(){return new w({fields:(0,c.o8)(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:(0,c.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:(0,c.o8)(this.popupTemplate),renderer:(0,c.o8)(this.renderer)})}};(0,i._)([(0,E.e)({binning:"binning"})],Z.prototype,"type",void 0),(0,i._)([(0,E.e)({geohash:"geohash"})],Z.prototype,"binType",void 0),(0,i._)([(0,a.MZ)({type:Number,range:{min:1,max:9},json:{write:!0}})],Z.prototype,"fixedBinLevel",void 0),(0,i._)([(0,a.MZ)({type:[V.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Z.prototype,"labelingInfo",void 0),(0,i._)([(0,a.MZ)(R.kF)],Z.prototype,"labelsVisible",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Z.prototype,"maxScale",void 0),(0,i._)([(0,a.MZ)(R.M6)],Z.prototype,"popupEnabled",void 0),(0,i._)([(0,a.MZ)({type:x.A,json:{name:"popupInfo",write:!0}})],Z.prototype,"popupTemplate",void 0),(0,i._)([(0,a.MZ)({type:[h],json:{write:!0}})],Z.prototype,"fields",void 0),(0,i._)([(0,F.K)("fields")],Z.prototype,"writeFields",null),(0,i._)([(0,a.MZ)({types:M.H,json:{write:{target:"drawingInfo.renderer"}}})],Z.prototype,"renderer",void 0),(0,i._)([(0,I.w)("renderer",["drawingInfo.renderer"])],Z.prototype,"readRenderer",null),Z=w=(0,i._)([(0,p.$)("esri.layers.support.FeatureReductionBinning")],Z);const T=Z;var j,z=r(95444),C=r(76931);function k(e){var t;return"simple"===e.type&&!(null!==(t=e.visualVariables)&&void 0!==t&&t.length)}let G=j=class extends d.oY{constructor(e){super(e),this.type="cluster",this.clusterRadius=(0,C.cr)("80px"),this.clusterMinSize=(0,C.cr)("12px"),this.clusterMaxSize=(0,C.cr)("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(e,t,r){var i,n,o;const l=null===(i=t.drawingInfo)||void 0===i?void 0:i.renderer;return null!==l&&void 0!==l&&null!==(n=l.authoringInfo)&&void 0!==n&&n.isAutoGenerated?null:l?k(l)?null:null!==(o=(0,s.L)(l,t,r))&&void 0!==o?o:void 0:(0,A.PD)(t,r)}readSymbol(e,t,r){var i,n;const o=null===(i=t.drawingInfo)||void 0===i?void 0:i.renderer;if(null!==o&&void 0!==o&&null!==(n=o.authoringInfo)&&void 0!==n&&n.isAutoGenerated)return null;if(o&&k(o)){const e=(0,s.L)(o,t,r);return null===e||void 0===e?void 0:e.symbol}return null}writeSymbol(e,t,r,i){var s;const o=null===(s=this.renderer)||void 0===s||null===(s=s.authoringInfo)||void 0===s?void 0:s.isAutoGenerated;if(!this.renderer||o){const r=new n.A({symbol:e});t.drawingInfo={renderer:r.write({},i)}}}writeFields(e,t,r){const i=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,S.sM)(r,i,t)}readFields(e,t,r){return e.filter((e=>!e.isAutoGenerated)).map((e=>h.fromJSON(e)))}clone(){return new j({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:(0,c.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:(0,c.o8)(this.fields),maxScale:this.maxScale,renderer:(0,c.o8)(this.renderer),symbol:(0,c.o8)(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:(0,c.o8)(this.popupTemplate)})}};(0,i._)([(0,a.MZ)({type:["cluster"],readOnly:!0,json:{write:!0}})],G.prototype,"type",void 0),(0,i._)([(0,a.MZ)({type:Number,cast:e=>"auto"===e?e:(0,C.cr)(e),json:{write:!0}})],G.prototype,"clusterRadius",void 0),(0,i._)([(0,a.MZ)({type:Number,cast:C.cr,json:{write:!0}})],G.prototype,"clusterMinSize",void 0),(0,i._)([(0,a.MZ)({type:Number,cast:C.cr,json:{write:!0}})],G.prototype,"clusterMaxSize",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],G.prototype,"maxScale",void 0),(0,i._)([(0,a.MZ)(R.M6)],G.prototype,"popupEnabled",void 0),(0,i._)([(0,a.MZ)({type:x.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],G.prototype,"popupTemplate",void 0),(0,i._)([(0,a.MZ)({types:M.H,json:{write:{target:"drawingInfo.renderer"}}})],G.prototype,"renderer",void 0),(0,i._)([(0,I.w)("renderer",["drawingInfo.renderer"])],G.prototype,"readRenderer",null),(0,i._)([(0,a.MZ)({types:z.q8})],G.prototype,"symbol",void 0),(0,i._)([(0,I.w)("symbol",["drawingInfo.renderer"])],G.prototype,"readSymbol",null),(0,i._)([(0,F.K)("symbol")],G.prototype,"writeSymbol",null),(0,i._)([(0,a.MZ)({type:[V.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],G.prototype,"labelingInfo",void 0),(0,i._)([(0,a.MZ)(R.kF)],G.prototype,"labelsVisible",void 0),(0,i._)([(0,a.MZ)({type:[h],json:{write:!0}})],G.prototype,"fields",void 0),(0,i._)([(0,F.K)("fields")],G.prototype,"writeFields",null),(0,i._)([(0,I.w)("fields")],G.prototype,"readFields",null),G=j=(0,i._)([(0,p.$)("esri.layers.support.FeatureReductionCluster")],G);const L=G;var N=r(89672);const $={key:"type",base:_.c,typeMap:{cluster:L,binning:T}},B={types:{key:"type",base:_.c,typeMap:{selection:N.A,cluster:L,binning:T}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:$},"portal-item":{types:$},"web-scene":{types:{key:"type",base:_.c,typeMap:{selection:N.A}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:g.K}}}}};var O=r(9272),q=r(63040),D=r(50076),H=r(53514),J=r(76045),K=r(76940);u.A.add("esri-cluster-arcade-enabled",!0);const U=(0,u.A)("esri-cluster-arcade-enabled"),Y=new Set(["simple-line","simple-fill","picture-fill"]);function P(e,t){let r=t.clone();if(!Q(r))return r;if(t.getSymbols().some((e=>Y.has(e.type)))&&(r=new n.A({symbol:new K.A})),r.authoringInfo||(r.authoringInfo=new J.A),r.authoringInfo.isAutoGenerated=!0,"visualVariables"in r){const t=(r.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression));t.forEach((t=>{"rotation"===t.type?t.field?t.field=X(e,t.field,"avg_angle","number"):t.valueExpression&&(t.field=W(e,t.valueExpression,"avg_angle","number"),t.valueExpression=null):t.normalizationField?(t.field=X(e,t.field,"avg_norm","number",t.normalizationField),t.normalizationField=null):t.field?t.field=X(e,t.field,"avg","number"):t.valueExpression&&(t.field=W(e,t.valueExpression,"avg","number"),t.valueExpression=null)})),r.visualVariables=t}switch(r.type){case"simple":break;case"pie-chart":for(const t of r.attributes)t.field?t.field=X(e,t.field,"sum","number"):t.valueExpression&&(t.field=W(e,t.valueExpression,"sum","number"),t.valueExpression=null);break;case"unique-value":r.field?r.field=X(e,r.field,"mode","string"):r.valueExpression&&(r.field=W(e,r.valueExpression,"mode","string"),r.valueExpression=null);break;case"class-breaks":r.normalizationField?(r.field=X(e,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=X(e,r.field,"avg","number"):r.valueExpression&&(r.field=W(e,r.valueExpression,"avg","number"),r.valueExpression=null)}return r}const Q=e=>{const t=t=>o.A.getLogger("esri.views.2d.layers.support.clusterUtils").error(new D.A("Unsupported-renderer",t,{renderer:e}));if(!e)return!1;switch(e.type){case"unique-value":if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(e.normalizationField){const r=e.normalizationType;if("field"!==r)return t("FeatureReductionCluster does not support a normalizationType of ".concat(r)),!1}break;case"simple":case"pie-chart":break;default:return t("FeatureReductionCluster does not support renderers of type ".concat(e.type)),!1}if(!U){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((e=>!(!("valueExpression"in e)||!e.valueExpression))))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function W(e,t,r,i){const n=(0,H.d)(t),s="mode"===r?"cluster_type_".concat(n):"sum"===r?"cluster_sum_".concat(n):"cluster_avg_".concat(n);return e.some((e=>e.name===s))||e.push(new h({name:s,isAutoGenerated:!0,onStatisticExpression:new v({expression:t,returnType:i}),statisticType:r})),s}function X(e,t,r,i,n){if("cluster_count"===t||e.some((e=>e.name===t)))return t;const s=function(e,t,r){switch(e){case"sum":return"cluster_sum_".concat(t);case"avg":case"avg_angle":return"cluster_avg_".concat(t);case"mode":return"cluster_type_".concat(t);case"avg_norm":{const e=r,i="field",n=t.toLowerCase()+",norm:"+i+","+e.toLowerCase();return"cluster_avg_"+(0,H.d)(n)}}}(r,t,n);return e.some((e=>e.name===s))||("avg_norm"===r?e.push(new h({name:s,isAutoGenerated:!0,onStatisticExpression:new v({expression:"$feature.".concat(t," / $feature.").concat(n),returnType:i}),statisticType:"avg"})):e.push(new h({name:s,isAutoGenerated:!0,onStatisticField:t,statisticType:r}))),s}const ee=e=>{let t=class extends e{constructor(){super(...arguments),this.addHandles((0,l.wB)((()=>this.renderer),(()=>{if(this.featureReduction){const e=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",e)}}),l.OH))}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}set renderer(e){}_withClusterVariable(e,t,r){const i=e.clone();return"visualVariables"in i&&(i.visualVariables||(i.visualVariables=[]),i.visualVariables.some((e=>"size"===e.type))||i.visualVariables.push(new O.A({field:"cluster_count",stops:[new q.A({value:1}),new q.A({useMinValue:!0,size:t}),new q.A({useMaxValue:!0,size:r})]}))),i}_normalizeFeatureReduction(e){var t,r;if("cluster"!==(null===e||void 0===e?void 0:e.type))return e;const i=e.clone(),s=[new h({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],o=(null!==(t=i.fields)&&void 0!==t?t:[]).filter((e=>!e.isAutoGenerated)),l=e.renderer&&!(null!==(r=e.renderer.authoringInfo)&&void 0!==r&&r.isAutoGenerated),{clusterMinSize:a,clusterMaxSize:u}=i;if(l){i.fields=[...s,...o];const e=this._withClusterVariable(i.renderer,a,u);return i.effectiveFeatureRenderer=e,i.effectiveClusterRenderer=e,i}if(e.symbol){if(i.fields=[...s,...o],i.renderer=null,!this.renderer)return i.effectiveFeatureRenderer=null,i.effectiveClusterRenderer=null,i;const t=P(s,this.renderer),r=this._withClusterVariable(t,a,u),l="visualVariables"in r&&r.visualVariables?r.visualVariables:[],p=new n.A({symbol:e.symbol,visualVariables:l});return i.fields=[...s,...o],i.effectiveFeatureRenderer=r,i.effectiveClusterRenderer=p,i}if(!this.renderer)return e;const p=P(s,this.renderer);i.fields=[...s,...o],i.renderer=p;const d=this._withClusterVariable(p,a,u);return i.effectiveFeatureRenderer=d,i.effectiveClusterRenderer=d,i}};return(0,i._)([(0,a.MZ)(B)],t.prototype,"featureReduction",null),t=(0,i._)([(0,p.$)("esri.layers.mixins.FeatureReductionLayer")],t),t}}}]);
//# sourceMappingURL=1448.9655bde4.chunk.js.map