"use strict";(self.webpackChunkweather_app=self.webpackChunkweather_app||[]).push([[1111],{80979:(e,t,n)=>{n.d(t,{K:()=>i});const i=["operational-layers","basemap","ground"]},70373:(e,t,n)=>{n.d(t,{w:()=>a});var i=n(18690),o=n(30015),r=n(61196);class a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,t=arguments.length>1?arguments[1]:void 0;this._compareMinX=u,this._compareMinY=h,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),w.prune(),b.prune(),x.prune(),_.prune()}all(e){this._all(this._data,e)}search(e,t){let n=this._data;const i=this._toBBox;if(g(e,n))for(w.clear();n;){for(let o=0,r=n.children.length;o<r;o++){const r=n.children[o],a=n.leaf?i(r):r;g(e,a)&&(n.leaf?t(r):f(e,a)?this._all(r,t):w.push(r))}n=w.pop()}}collides(e){let t=this._data;const n=this._toBBox;if(!g(e,t))return!1;for(w.clear();t;){for(let i=0,o=t.children.length;i<o;i++){const o=t.children[i],r=t.leaf?n(o):o;if(g(e,r)){if(t.leaf||f(e,r))return!0;w.push(o)}}t=w.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new L([]),this}remove(e){if(!e)return this;let t,n=this._data,o=null,r=0,a=!1;const s=this._toBBox(e);for(x.clear(),_.clear();n||x.length>0;){var l;if(n||(n=x.pop(),o=x.data[x.length-1],r=null!==(l=_.pop())&&void 0!==l?l:0,a=!0),n.leaf&&(t=(0,i.qh)(n.children,e,n.children.length,n.indexHint),-1!==t))return n.children.splice(t,1),x.push(n),this._condense(x),this;a||n.leaf||!f(n,s)?o?(r++,n=o.children[r],a=!1):n=null:(x.push(n),_.push(r),r=0,o=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_all(e,t){let n=e;for(b.clear();n;){var i;if(!0===n.leaf)for(const e of n.children)t(e);else b.pushArray(n.children);n=null!==(i=b.pop())&&void 0!==i?i:null}}_build(e,t,n,i){const o=n-t+1;let r=this._maxEntries;if(o<=r){const i=new L(e.slice(t,n+1));return s(i,this._toBBox),i}i||(i=Math.ceil(Math.log(o)/Math.log(r)),r=Math.ceil(o/r**(i-1)));const a=new I([]);a.height=i;const l=Math.ceil(o/r),d=l*Math.ceil(Math.sqrt(r));v(e,t,n,d,this._compareMinX);for(let s=t;s<=n;s+=d){const t=Math.min(s+d-1,n);v(e,s,t,l,this._compareMinY);for(let n=s;n<=t;n+=l){const o=Math.min(n+l-1,t);a.children.push(this._build(e,n,o,i-1))}}return s(a,this._toBBox),a}_chooseSubtree(e,t,n,i){for(;i.push(t),!0!==t.leaf&&i.length-1!==n;){let n,i=1/0,o=1/0;for(let r=0,a=t.children.length;r<a;r++){const a=t.children[r],s=p(a),l=y(e,a)-s;l<o?(o=l,i=s<i?s:i,n=a):l===o&&s<i&&(i=s,n=a)}t=n||t.children[0]}return t}_insert(e,t,n){const i=this._toBBox,o=n?e:i(e);x.clear();const r=this._chooseSubtree(o,this._data,t,x);for(r.children.push(e),d(r,o);t>=0&&x.data[t].children.length>this._maxEntries;)this._split(x,t),t--;this._adjustParentBBoxes(o,x,t)}_split(e,t){const n=e.data[t],i=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,i);const r=this._chooseSplitIndex(n,o,i);if(!r)return void console.log("  Error: assertion failed at PooledRBush._split: no valid split index");const a=n.children.splice(r,n.children.length-r),l=n.leaf?new L(a):new I(a);l.height=n.height,s(n,this._toBBox),s(l,this._toBBox),t?e.data[t-1].children.push(l):this._splitRoot(n,l)}_splitRoot(e,t){this._data=new I([e,t]),this._data.height=e.height+1,s(this._data,this._toBBox)}_chooseSplitIndex(e,t,n){let i,o,r;i=o=1/0;for(let a=t;a<=n-t;a++){const t=l(e,0,a,this._toBBox),s=l(e,a,n,this._toBBox),d=m(t,s),u=p(t)+p(s);d<i?(i=d,r=a,o=u<o?u:o):d===i&&u<o&&(o=u,r=a)}return r}_chooseSplitAxis(e,t,n){const i=e.leaf?this._compareMinX:u,o=e.leaf?this._compareMinY:h;this._allDistMargin(e,t,n,i)<this._allDistMargin(e,t,n,o)&&e.children.sort(i)}_allDistMargin(e,t,n,i){e.children.sort(i);const o=this._toBBox,r=l(e,0,t,o),a=l(e,n-t,n,o);let s=c(r)+c(a);for(let l=t;l<n-t;l++){const t=e.children[l];d(r,e.leaf?o(t):t),s+=c(r)}for(let l=n-t-1;l>=t;l--){const t=e.children[l];d(a,e.leaf?o(t):t),s+=c(a)}return s}_adjustParentBBoxes(e,t,n){for(let i=n;i>=0;i--)d(t.data[i],e)}_condense(e){for(let t=e.length-1;t>=0;t--){const n=e.data[t];if(0===n.children.length)if(t>0){const o=e.data[t-1],r=o.children;r.splice((0,i.qh)(r,n,r.length,o.indexHint),1)}else this.clear();else s(n,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function s(e,t){l(e,0,e.children.length,t,e)}function l(e,t,n,i,o){o||(o=new L([])),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let r,a=t;a<n;a++)r=e.children[a],d(o,e.leaf?i(r):r);return o}function d(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function u(e,t){return e.minX-t.minX}function h(e,t){return e.minY-t.minY}function p(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function c(e){return e.maxX-e.minX+(e.maxY-e.minY)}function y(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function m(e,t){const n=Math.max(e.minX,t.minX),i=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),r=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,r-i)}function f(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function v(e,t,n,i,o){const a=[t,n];for(;a.length;){const t=a.pop(),n=a.pop();if(t-n<=i)continue;const s=n+Math.ceil((t-n)/i/2)*i;(0,r.q)(e,s,n,t,o),a.push(n,s,s,t)}}const w=new o.A,b=new o.A,x=new o.A,_=new o.A({deallocator:void 0});class M{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class T extends M{constructor(){super(...arguments),this.height=1,this.indexHint=new i.vW}}class L extends T{constructor(e){super(),this.children=e,this.leaf=!0}}class I extends T{constructor(e){super(),this.children=e,this.leaf=!1}}},26486:(e,t,n)=>{n.d(t,{Hq:()=>_,Qj:()=>T,V2:()=>m,m_:()=>f});n(81806);var i=n(15941),o=n(76797),r=n(65215),a=n(13312),s=n(14556),l=n(98618),d=n(1484),u=n(24586);const h=new Float64Array(2),p=new Float64Array(2),c="0123456789bcdefghjkmnpqrstuvwxyz",y=64;function m(e,t,n,i){const s=[e.xmin,e.ymin,e.xmax,e.ymax],h=r.A.fromExtent(o.A.fromBounds(s,i)),p=(0,u.Cv)(h,i,a.A.WGS84,{densificationStep:t*y});if(!p)return null;const c=(0,l.Ye)(new d.A,p,!1,!1),m=c.coords.filter(((e,t)=>!(t%2))),g=c.coords.filter(((e,t)=>t%2)),v=Math.min(...m),w=Math.min(...g),b=Math.max(...m),x=Math.max(...g),_=f(v,w,n,a.A.WGS84),M=f(b,x,n,a.A.WGS84);return _&&M?{bounds:s,geohashBounds:{xLL:_[0],yLL:_[1],xTR:M[0],yTR:M[1]},level:n}:null}function f(e,t,n,o){if(o.isWebMercator){const o=(0,i.KJ)(e/s.$O.radius),r=o-360*Math.floor((o+180)/360),a=[0,0];return M(a,0,(0,i.KJ)(Math.PI/2-2*Math.atan(Math.exp(-t/s.$O.radius))),r,n),a}const r=(0,u.Cv)({x:e,y:t},o,a.A.WGS84);if(!r)return null;const l=[0,0];return M(l,0,r.y,r.x,n),l}function g(e){return c[e]}function v(e){return(e[0]+e[1])/2}function w(e,t,n){return e[0]=t,e[1]=n,e}function b(e,t){const n=v(e),i=t,o=!t;e[0]=o*e[0]+i*n,e[1]=o*n+i*e[1]}function x(e,t){const n=t>v(e);return b(e,n),n}function _(e,t){let n=-90,i=90,o=-180,r=180;for(let a=0;a<t;a++){const t=Math.ceil((a+1)/2),s=Math.floor((a+1)/2),l=1-a%2,d=30-(3*t+2*s),u=30-(2*t+3*s),h=3*l+2*(1-l),p=2*l+3*(1-l),c=3*l+7*(1-l)<<u,y=(7*l+3*(1-l)<<d&e.geohashX)>>d,m=(c&e.geohashY)>>u;for(let e=h-1;e>=0;e--){const t=(o+r)/2,n=y&1<<e?1:0;o=(1-n)*o+n*t,r=(1-n)*t+n*r}for(let e=p-1;e>=0;e--){const t=(n+i)/2,o=m&1<<e?1:0;n=(1-o)*n+o*t,i=(1-o)*t+o*i}}return[o,n,r,i]}function M(e,t,n,i,o){o%2&&(o+=1);let r=0,a=0,s=-90,l=90,d=-180,u=180;for(let h=0;h<o/2;h++){for(let e=0;e<5;e++){const t=(d+u)/2,n=i>t?1:0;r|=n<<29-(e+5*h),d=(1-n)*d+n*t,u=(1-n)*t+n*u}for(let e=0;e<5;e++){const t=(s+l)/2,i=n>t?1:0;a|=i<<29-(e+5*h),s=(1-i)*s+i*t,l=(1-i)*t+i*l}}e[2*t]=r,e[2*t+1]=a}function T(e,t,n){let i="";const o=w(h,-90,90),r=w(p,-180,180);for(let a=0;a<n;a++){let n=0;a%2?(n|=x(o,e)<<4,n|=x(r,t)<<3,n|=x(o,e)<<2,n|=x(r,t)<<1,n|=x(o,e)|0):(n|=x(r,t)<<4,n|=x(o,e)<<3,n|=x(r,t)<<2,n|=x(o,e)<<1,n|=x(r,t)|0),i+=g(n)}return i}},36744:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Se});var i=n(35143),o=(n(35238),n(94643)),r=n(50076),a=n(76460),s=n(50346),l=n(46053),d=(n(81806),n(47249),n(85842)),u=n(26486),h=n(25515),p=n(98618),c=n(1484),y=n(91967),m=n(87663),f=n(34154),g=n(65215),v=n(26346),w=n(80963),b=n(20176),x=n(19902);class _{constructor(){this._featureLookup=new Map}static getInstance(){return _.instance||(_.instance=new _),_.instance}static resetInstance(){_.instance&&(_.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const n=this.readFromStoreById(e);n&&t.push(n)})),t}readFromStoreById(e){var t;return null!==(t=this._featureLookup.get(e))&&void 0!==t?t:null}writeToStore(e,t,n){const i=[];return e.forEach((e=>{if(null===e||void 0===e||!e.id)return;e.properties||(e.properties=[]);let o,r=null;if(n&&e.properties[n]&&(r=(0,p.Ux)(e.properties[n])),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const i=this._featureLookup.get(e.id),a=JSON.parse(JSON.stringify(Object.assign(i.attributes,e.properties)));n&&e.properties[n]&&(a[n]=(0,x.rS)(e.properties[n])),o=new b.Om(r?JSON.parse(JSON.stringify(r)):null!==i&&void 0!==i&&i.geometry?JSON.parse(JSON.stringify(i.geometry)):null,a,null,e.properties[t])}else o=new b.Om(r?JSON.parse(JSON.stringify(r)):null,e.properties,null,e.properties[t]);this._featureLookup.set(e.id,o),i.push(o)})),i}}n(3825);var M,T=n(3576),L=n(35380);n(13312);!function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"}(M||(M={}));M.ELEMENTUID,M.TYPENAME;var I,E;!function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(I||(I={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(E||(E={}));var C,S,k,A;n(57502),n(31830);function N(e){if(!e.spatialReference.isWGS84)throw new r.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");let t;return t=e.xmax>180&&e.xmin<180?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[180,e.ymax],[180,e.ymin],[e.xmin,e.ymin]],[[-180,e.ymin],[-180,e.ymax],[e.xmax-360,e.ymax],[e.xmax-360,e.ymin],[-180,e.ymin]]]:e.xmax>180&&e.xmin>180?[[[e.xmin-360,e.ymin],[e.xmin-360,e.ymax],[e.xmax-360,e.ymax],[e.xmax-360,e.ymin],[e.xmin-360,e.ymin]]]:e.xmax>-180&&e.xmin<-180?[[[e.xmin+360,e.ymin],[e.xmin+360,e.ymax],[180,e.ymax],[180,e.ymin],[e.xmin+360,e.ymin]],[[-180,e.ymin],[-180,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[-180,e.ymin]]]:e.xmax<-180&&e.xmin<-180?[[[e.xmin+360,e.ymin],[e.xmin+360,e.ymax],[e.xmax+360,e.ymax],[e.xmax+360,e.ymin],[e.xmin+360,e.ymin]]]:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]],t}!function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(C||(C={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(S||(S={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(k||(k={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(A||(A={}));var D=n(97015),R=n(76797);const j="ESRI__ID",B="ESRI__ORIGIN_ID",P="ESRI__DESTINATION_ID",G="ESRI__LAYOUT_GEOMETRY",F="ESRI__AGGREGATION_COUNT",Z=12;let O=class extends y.A{constructor(e){var t,n,i;super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const o=new Map;null!==(t=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==t&&t.forEach((t=>{var n,i;t.name&&(o.set(t.name,"entity"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(n=e.inclusionModeDefinition)&&void 0!==n&&n.generateAllSublayers)||this.entityTypeNames.add(t.name),null===(i=t.properties)||void 0===i||i.forEach((e=>{var n;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(n=e.name)&&void 0!==n?n:"",geometryType:e.geometryType})})))})),null!==(n=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==n&&n.forEach((t=>{var n,i;t.name&&(o.set(t.name,"relationship"),this._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(n=e.inclusionModeDefinition)&&void 0!==n&&n.generateAllSublayers)||this.relationshipTypeNames.add(t.name),null===(i=t.properties)||void 0===i||i.forEach((e=>{var n;e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(t.name,{name:null!==(n=e.name)&&void 0!==n?n:"",geometryType:e.geometryType})})))})),null===(i=e.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.forEach(((t,n)=>{var i;if("entity"===o.get(n))this.entityTypeNames.add(n);else{var r;if("relationship"!==o.get(n))return a.A.getLogger(this).warn("A named type, ".concat(n,", was in the inclusion list that wasn't in the data model and will be removed")),void(null===(r=e.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.delete(n));this.relationshipTypeNames.add(n)}const s=new Map;null!==(i=t.members)&&void 0!==i&&i.forEach((e=>{(0,m.tE)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(n);const t=this.getById(e.id);t&&s.set(e.id,t)})),this.sublayerCaches.set(n,s)}))}addToLayer(e){e.forEach((e=>{let{typeName:t,id:n}=e;if(!this.inclusionModeDefinition)throw new r.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const e=this.inclusionModeDefinition.namedTypeDefinitions.get(t);e.members||(e.members=new Map),e.members.set(n,{id:n}),(0,m.tE)(this.memberIdTypeLookup,n,(()=>new Set)).add(t)}}else{const e=new Map;e.set(n,{id:n}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:e}),(0,m.tE)(this.memberIdTypeLookup,n,(()=>new Set)).add(t)}}))}getById(e){return _.getInstance().readFromStoreById(e)}async getData(e,t,n){var i;if(t.objectType.name&&null!==(i=this.inclusionModeDefinition)&&void 0!==i&&i.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let o;if(o=e||new D.A({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){var r,a,s;const e=t.parentCompositeLayer,n=this._processingCacheUpdatesLookup.get(null!==(r=t.objectType.name)&&void 0!==r?r:""),i=o.outFields,l=o.geometry;let d="",h="";l&&l.extent&&(d=(0,u.Qj)(l.extent.ymin,l.extent.xmin,Z),h=(0,u.Qj)(l.extent.ymax,l.extent.xmax,Z)),i&&1===i.length&&i[0]===j&&"1=1"===o.where||await Promise.all(null!==n&&void 0!==n?n:[]);const p=this.sublayerCaches.has(null!==(a=t.objectType.name)&&void 0!==a?a:"")?Array.from(null===(s=this.sublayerCaches.get(t.objectType.name))||void 0===s?void 0:s.values()):[],c=[];return p.forEach((n=>{if(this.relationshipTypeNames.has(t.objectType.name)?n.geometry=e.relationshipLinkChartDiagramLookup.get(n.attributes[t.objectIdField]):n.geometry=e.entityLinkChartDiagramLookup.get(n.attributes[t.objectIdField]),n.attributes[G]=n.geometry,d&&h){const i=e.linkChartGeohashLookup.get(n.attributes[t.objectIdField]);i?i>=d&&i<=h&&c.push(n):c.push(n)}else c.push(n)})),c}return this.retrieveDataFromService(o,t,n)}async getConnectedRecordIds(e,t){const n=[];let i="";const o=[],r=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const n of this.memberIdTypeLookup.get(e)){var t;if(!this.entityTypeNames.has(n))return;r.has(n)?null===(t=r.get(n))||void 0===t||t.push(e):r.set(n,[e])}})),t&&0!==(null===t||void 0===t?void 0:t.length)){for(const e of t)i=i+e+"|";i=i.slice(0,-1)}return r.forEach(((e,r)=>{let s;s=t&&0!==(null===t||void 0===t?void 0:t.length)?"MATCH (n:".concat(r,")-[r:").concat(i,"]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]"):"MATCH (n:".concat(r,")-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]");const l=new Promise((t=>{(async()=>{const t=(await(0,T.executeQueryStreaming)(this.knowledgeGraph,new L.A({openCypherQuery:s,bindParameters:{ids:e}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:i}=await t.read();if(e)break;for(let t=0;t<i.length;t++){const e=i[t];n.push({id:e[0],typeName:e[1]}),n.push({id:e[2],typeName:e[3]})}}}catch(i){if("AbortError"!==i.name)throw i;a.A.getLogger(this).info("Request aborted as expected")}})().then((()=>{t()}))}));o.push(l)})),this.refreshCacheContent(),await Promise.all(o),n}async refreshCacheContent(e,t,n){var i,o,a,s,l;let d=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const u=_.getInstance(),h=[],p=new Map,c=new Map;null!==(i=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==i&&i.forEach((e=>{e.name&&c.set(e.name,e)})),null!==(o=this.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==o&&o.forEach((e=>{e.name&&c.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const n of this.memberIdTypeLookup.get(e)){var t;p.has(n)?null===(t=p.get(n))||void 0===t||t.push(e):p.set(n,[e])}})):null===(a=this.inclusionModeDefinition)||void 0===a||null===(a=a.namedTypeDefinitions)||void 0===a||a.forEach(((e,t)=>{e.useAllData?p.set(t,null):e.members&&e.members.forEach((e=>{var n;p.has(t)&&null!==p.get(t)?null===(n=p.get(t))||void 0===n||n.push(e.id):p.set(t,[e.id])}))})):(null!==(s=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==s&&s.forEach((e=>{e.name&&p.set(e.name,null)})),null===(l=this.knowledgeGraph.dataModel.entityTypes)||void 0===l||l.forEach((e=>{e.name&&p.set(e.name,null)})));for(const[f,g]of p){var y;const e=new Promise((e=>{(async()=>{var e;const i=new Set,o=[];let a,s="",l=!1;if(t||null!==(e=c.get(f))&&void 0!==e&&null!==(e=e.properties)&&void 0!==e&&e.forEach((e=>{e.name&&i.add(e.name)})),n&&this.geographicLookup.has(f)){var h;const e=null===(h=this.geographicLookup.get(f))||void 0===h?void 0:h.name;e&&i.add(e)}if(this.entityTypeNames.has(f))s="MATCH (n:".concat(f,") ").concat(g?"WHERE id(n) IN $ids ":"","return ID(n)"),i.forEach((e=>{s+=", n.".concat(e),o.push(e)}));else{if(!this.relationshipTypeNames.has(f))throw new r.A("knowledge-graph:layer-data-manager","The graph type of ".concat(f," could not be determined. Was this type set in the KG data model and inclusion definition?"));l=!0,s="MATCH ()-[n:".concat(f,"]->() ").concat(g?"WHERE id(n) IN $ids ":"","return ID(n), id(startNode(n)), id(endNode(n))"),i.forEach((e=>{s+=", n.".concat(e),o.push(e)}))}a=new L.A(g?{openCypherQuery:s,bindParameters:{ids:g}}:{openCypherQuery:s});const p=(await(0,T.executeQueryStreaming)(this.knowledgeGraph,a)).resultRowsStream.getReader();for(;;){var y,v,w,b;const{done:e,value:t}=await p.read();if(e)break;const n=[];for(let a=0;a<t.length;a++){const e=t[a];let i=0,r=0;const s={properties:{}};for(s.id=e[i],i++,r++,l&&(s.originId=e[i],i++,r++,s.destinationId=e[i],i++,r++,(0,m.tE)(this.nodeConnectionsLookup,s.originId,(()=>new Set)).add(s.id),(0,m.tE)(this.nodeConnectionsLookup,s.destinationId,(()=>new Set)).add(s.id),(0,m.tE)(this.relationshipConnectionsLookup,s.id,(()=>[s.originId,s.destinationId])));i<e.length;i++)s.properties[o[i-r]]=e[i];n.push(s)}const i=u.writeToStore(n,j,null===(y=this.geographicLookup.get(f))||void 0===y?void 0:y.name);this.sublayerCaches.has(f)||this.sublayerCaches.set(f,new Map),d&&!(null!==(v=this.inclusionModeDefinition)&&void 0!==v&&v.namedTypeDefinitions.has(f))&&null!==(w=this.inclusionModeDefinition)&&void 0!==w&&w.namedTypeDefinitions.set(f,{useAllData:!1,members:new Map}),d&&(null===(b=this.inclusionModeDefinition)||void 0===b||!b.namedTypeDefinitions.get(f).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(f).members=new Map);const r=this.sublayerCaches.get(f);i.forEach((e=>{var t,n;null!==r&&void 0!==r&&r.set(e.attributes[j],e),d&&(null===(t=this.inclusionModeDefinition)||void 0===t||!t.namedTypeDefinitions.get(f).members.has(e.attributes[j]))&&(null!==(n=this.inclusionModeDefinition)&&void 0!==n&&n.namedTypeDefinitions.get(f).members.set(e.attributes[j],{id:e.attributes[j]}),(0,m.tE)(this.memberIdTypeLookup,e.attributes[j],(()=>new Set)).add(f))}))}})().then((()=>{e(null)}))}));h.push(e),null===(y=this._processingCacheUpdatesLookup.get(f))||void 0===y||y.push(e)}await Promise.all(h)}removeFromLayer(e){const t=new Set,n=new Set(e.map((e=>e.id)));for(const a of e){var i,o,r;t.add(a.typeName),1===(null===(i=this.memberIdTypeLookup.get(a.id))||void 0===i?void 0:i.size)?this.memberIdTypeLookup.delete(a.id):null===(o=this.memberIdTypeLookup.get(a.id))||void 0===o||o.delete(a.typeName),null===(r=this.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.forEach(((e,t)=>{var n;t===a.typeName&&(null===(n=e.members)||void 0===n?void 0:n.has(a.id))&&e.members.delete(a.id)}))}t.forEach((e=>{var t;null===(t=this.sublayerCaches.get(e))||void 0===t||t.forEach(((t,i)=>{var o;n.has(i)&&(null===(o=this.sublayerCaches.get(e))||void 0===o||o.delete(i))}))}))}async retrieveDataFromService(e,t,n){var i,o,a;const s=_.getInstance(),l=new Set,d=[];let u,h="",p=[];const c="relationship"===t.graphType,y=null===(i=this.inclusionModeDefinition)||void 0===i||null===(i=i.namedTypeDefinitions)||void 0===i||null===(i=i.get(t.objectType.name))||void 0===i?void 0:i.useAllData,m=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let b=!y&&m?Array.from(m).sort():null;if(null!==(o=this.inclusionModeDefinition)&&void 0!==o&&null!==(o=o.namedTypeDefinitions)&&void 0!==o&&null!==(o=o.get(t.objectType.name))&&void 0!==o&&o.useAllData)(null===(a=this.inclusionModeDefinition)||void 0===a||null===(a=a.namedTypeDefinitions)||void 0===a||null===(a=a.get(t.objectType.name))||void 0===a?void 0:a.useAllData)&&null!=e.objectIds&&(b=e.objectIds);else if(null!=e.objectIds&&b&&b.length>0){const t=e.objectIds;e.objectIds=b.filter((e=>t.includes(e)))}else if(null!=e.objectIds)b=e.objectIds;else{var x,M,I;if(null!==(x=this.inclusionModeDefinition)&&void 0!==x&&x.namedTypeDefinitions.has(t.objectType.name)&&(null===(M=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===M||!M.members||(null===(I=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))||void 0===I||null===(I=I.members)||void 0===I?void 0:I.size)<1))return e.objectIds=[],[];e.objectIds=b}if(null!=e.outFields){const n=e.outFields;n.includes("*")?t.fields.forEach((e=>{l.add(e.name)})):n.forEach((e=>{e!==j&&e!==t.geometryFieldName&&l.add(e)}))}if(null!=e.geometry){var E,C,S;const n=e.geometry;let i;const o=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,a=null===o||void 0===o?void 0:o.spatialReference,s=null===o||void 0===o||null===(E=o.serviceCapabilities)||void 0===E?void 0:E.geometryCapabilities;let p=null===s||void 0===s?void 0:s.geometryMaxBoundingRectangleSizeX,y=null===s||void 0===s?void 0:s.geometryMaxBoundingRectangleSizeY;if(null===n||void 0===n||null===(C=n.extent)||void 0===C||!C.spatialReference||null!==(S=n.spatialReference)&&void 0!==S&&S.isWGS84?i=n.extent:(await(0,v.initializeProjection)(n.extent.spatialReference,w.KK),i=(0,v.project)(n.extent,w.KK)),p&&y&&a){if(4326!==a.wkid){const e=new R.A({spatialReference:a,xmax:p,ymax:y}),t=(0,v.project)(e,w.KK);p=t.xmax,y=t.ymax}if(i.xmax-i.xmin>p)throw new r.A("knowledge-graph:layer-data-manager","Extent x bounds should be within ".concat(p,"\xb0 latitude, limit exceeded"));if(i.ymax-i.ymin>y)throw new r.A("knowledge-graph:layer-data-manager","Extent y bounds should be within ".concat(y,"\xb0 longitude, limit exceeded"))}if(null!=e.where&&"1=1"!==e.where){const n=await(0,f.G)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&l.add(e.name)}))}h=c?"Match ()-[n:".concat(t.objectType.name,"]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n), id(startNode(r)), id(endNode(r))"):"Match (n:".concat(t.objectType.name,") WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(t.geometryFieldName,") return ID(n)"),t.geometryFieldName&&l.add(t.geometryFieldName),l.forEach((e=>{h+=", n.".concat(e),d.push(e)})),u=new L.A({openCypherQuery:h,bindParameters:{param_filter_geom:new g.A({rings:N(i)})}})}else{let n="";if(null!=e.where&&"1=1"!==e.where){const i=await(0,f.G)(e.where,t.fieldsIndex);t.fields.forEach((e=>{i.fieldNames.includes(e.name)&&l.add(e.name)}));const o=new Set(["column-reference","string","number","binary-expression"]),r=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let a=!1;const s=e=>{if("column-reference"===e.type)return"n.".concat(e.column);if("string"===e.type)return"'".concat(e.value,"'");if("number"===e.type)return"".concat(e.value);if("binary-expression"===e.type&&o.has(e.left.type)&&o.has(e.right.type)&&r.has(e.operator))return"".concat(s(e.left)," ").concat(e.operator," ").concat(s(e.right));if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+="lower(n.".concat(e.left.args.value[0].column,")");else{if("column-reference"!==e.left.type)return a=!0,"";t+="lower(n.".concat(e.left.column,")")}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let n=e.right.value;"%"===n.charAt(0)&&(n=n.slice(1)),"%"===n.charAt(n.length-1)&&(n=n.slice(0,-1)),t+="'".concat(n.toLowerCase(),"')")}return t}return a=!0,""};n=s(i.parseTree),a&&(n="")}let i="";i=c?"Match ()-[n:".concat(t.objectType.name,"]->()"):"Match (n:".concat(t.objectType.name,")");let o=!1;b&&(o=!0,i+=" WHERE ID(n) IN $ids"),n&&(i+=o?" AND":" WHERE",i+=" ".concat(n)),i+=" return ID(n)",c&&(i+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&l.add(t.geometryFieldName),l.forEach((e=>{i+=", n.".concat(e),d.push(e)})),u=new L.A(b?{openCypherQuery:i,bindParameters:{ids:b}}:{openCypherQuery:i})}const k=(await(0,T.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,u,n)).resultRowsStream.getReader();for(;;){var A;const{done:e,value:n}=await k.read();if(e)break;const i=[];for(let t=0;t<n.length;t++){const e=n[t];let o=0,r=0;const a={properties:{}};for(a.id=e[o],o++,r++,c&&(a.originId=e[o],o++,r++,a.destinationId=e[o],o++,r++);o<e.length;o++)a.properties[d[o-r]]=e[o];i.push(a)}p=p.concat(s.writeToStore(i,j,null===(A=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))||void 0===A?void 0:A.name))}return p}};(0,i._)([(0,l.MZ)()],O.prototype,"knowledgeGraph",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"inclusionModeDefinition",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"entityTypeNames",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"relationshipTypeNames",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"geographicLookup",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"sublayerCaches",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"nodeConnectionsLookup",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"relationshipConnectionsLookup",void 0),(0,i._)([(0,l.MZ)()],O.prototype,"memberIdTypeLookup",void 0),O=(0,i._)([(0,d.$)("esri.rest.knowledgeGraph.knowledgeGraphLayer.KnowledgeGraphLayerDataManager")],O);var q=n(16868),Y=(n(63844),n(14873),n(47662),n(72690),n(86946),n(71832),n(5766),n(35039),n(86616)),Q=n(31382),U=(n(16783),n(72547)),z=n(28642),J=n(40296);const H=(0,n(76350).p)(),X=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,i._)([(0,l.MZ)(H.fields)],t.prototype,"fields",void 0),(0,i._)([(0,l.MZ)(H.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,i._)([(0,d.$)("esri.layers.knowledgeGraphLayer.KnowledgeGraphSublayerBase")],t),t};var $=n(65624),K=n(71448),W=n(21617),V=n(5682),ee=n(55053),te=n(44135),ne=n(53430),ie=n(77725),oe=n(30973),re=n(59989),ae=n(23701),se=n(31608);let le=class extends((0,K.J)(X((0,$.d)((0,V.j)((0,W.J)(h.A)))))){constructor(e){var t,n,i,o,r;if(super(e),t=this,this.capabilities=(0,J.f)(!1,!1),this.definitionExpression="",this.displayField="",this.elevationInfo=null,this.geometryType=null,this.geometryFieldName=null,this.graphType=null,this.hasM=!1,this.hasZ=!1,this.labelsVisible=null,this.labelingInfo=null,this.objectIdField=j,this.objectType=null,this.parentCompositeLayer=null,this.popupEnabled=!0,this.popupTemplate=null,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new re.A(e.port1,{channel:e,client:{queryFeatures:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=D.A.fromJSON(e);return t.queryFeaturesJSON(i,n)}}}),[e.port2]}))},this.type="knowledge-graph-sublayer","link-chart"===e.parentCompositeLayer.type)"relationship"===e.graphType?this.geometryType="polyline":this.geometryType="point",this.geometryFieldName=G;else if(null!==(n=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))&&void 0!==n&&n.geometryType&&"esriGeometryNull"!==(null===(i=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))||void 0===i?void 0:i.geometryType)){var a,s,l,d;const t=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name);this.geometryFieldName=null!==(a=null===t||void 0===t?void 0:t.name)&&void 0!==a?a:null,this.geometryType=null!==t&&void 0!==t&&t.geometryType?se.g.fromJSON(t.geometryType):null;const n=null===t||void 0===t?void 0:t.name,i=n?null===(s=e.objectType.properties)||void 0===s?void 0:s[n]:null;i?(this.hasM=null!==(l=i.hasM)&&void 0!==l&&l,this.hasZ=null!==(d=i.hasZ)&&void 0!==d&&d):(this.hasM=!1,this.hasZ=!1)}else this.geometryType=null;null!==(o=e.objectType.properties)&&void 0!==o&&o.forEach((e=>{let t=e.fieldType;"esriFieldTypeOID"===t&&(t="esriFieldTypeInteger"),this.fields.push(te.A.fromJSON({name:e.name,type:t,alias:e.alias,defaultValue:null,editable:e.editable,nullable:e.nullable}))})),this.fields.push(te.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1})),this.fields.push(te.A.fromJSON({name:F,type:"esriFieldTypeInteger",alias:F,editable:!1})),this._set("fields",[...this.fields]),null!==(r=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel)&&void 0!==r&&r.spatialReference&&(this.spatialReference=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel.spatialReference),"link-chart"===e.parentCompositeLayer.type?"relationship"===e.graphType?this.renderer=(0,Y.r)((0,J.F0)(se.g.toJSON("polyline")).renderer):this.renderer=(0,Y.r)((0,J.F0)(se.g.toJSON("point")).renderer):this.renderer=(0,Y.r)((0,J.F0)(se.g.toJSON(this.geometryType)).renderer)}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){(0,ne.yp)(e,this.fieldsIndex),this._set("renderer",e)}createPopupTemplate(e){return(0,oe.tn)(this,e)}createQuery(){return new D.A({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e),o=ie.A.fromJSON(await i.executeQuery(n.toJSON(),null===t||void 0===t?void 0:t.signal));return o.features.forEach((e=>{e.sourceLayer=this})),o}async queryFeaturesJSON(e,t){const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e);return await i.executeQuery(n.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryFeatureCount(e,t){const{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(e);return i.executeQueryForCount(n.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryExtent(){var e,t,n,i;let o=arguments.length>1?arguments[1]:void 0;const r={...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},returnGeometry:!0},{resolvedQuery:a,queryEngine:s}=await this._setupQueryObjects(r),l=await s.executeQueryForExtent(a.toJSON(),null===o||void 0===o?void 0:o.signal);let d;return d=null!=(null===(e=l.extent)||void 0===e?void 0:e.xmin)&&null!=(null===(t=l.extent)||void 0===t?void 0:t.xmax)&&null!=(null===(n=l.extent)||void 0===n?void 0:n.ymin)&&null!=(null===(i=l.extent)||void 0===i?void 0:i.ymax)?new R.A(l.extent):new R.A,{count:l.count,extent:d}}async queryObjectIds(e,t){const n=D.A.from(e);let i;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)i=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);i=this.loadQueryEngine(e)}return i.executeQueryForIds(n.toJSON(),null===t||void 0===t?void 0:t.signal)}loadQueryEngine(e){const t=new U.A({geometryType:se.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new z.d({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:se.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new D.A({where:"1=1",outFields:[j]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}async _setupQueryObjects(e,t){var n;const i=D.A.from(e),o=i.geometry;let r;if(o&&!(null!==(n=o.spatialReference)&&void 0!==n&&n.isWGS84)&&(await(0,v.initializeProjection)(o.spatialReference,w.KK),i.geometry=(0,v.project)(o instanceof g.A||o instanceof ae.A?o:o.extent,w.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(i,this,t);r=this.loadQueryEngine(e)}return{resolvedQuery:i,queryEngine:r}}};(0,i._)([(0,l.MZ)()],le.prototype,"capabilities",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],le.prototype,"defaultPopupTemplate",null),(0,i._)([(0,l.MZ)()],le.prototype,"definitionExpression",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"displayField",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"elevationInfo",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"geometryType",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"geometryFieldName",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"graphType",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"hasM",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"hasZ",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"labelsVisible",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"labelingInfo",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"objectIdField",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"objectType",void 0),(0,i._)([(0,l.MZ)()],le.prototype,"parentCompositeLayer",void 0),(0,i._)([(0,l.MZ)(ee.M6)],le.prototype,"popupEnabled",void 0),(0,i._)([(0,l.MZ)({type:q.A,json:{name:"popupInfo",write:!0}})],le.prototype,"popupTemplate",void 0),(0,i._)([(0,l.MZ)({types:Q.H,json:{write:{target:"layerDefinition.drawingInfo.renderer"}}})],le.prototype,"renderer",null),(0,i._)([(0,l.MZ)()],le.prototype,"source",void 0),(0,i._)([(0,l.MZ)({json:{read:!1}})],le.prototype,"type",void 0),le=(0,i._)([(0,d.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],le);const de=le;var ue=n(28899);let he,pe=null;function ce(){return he||(he=n.e(3884).then(n.bind(n,83884)).then((e=>e.l)).then((e=>{let{default:t}=e;return t({locateFile:e=>(0,ue.s)("esri/libs/linkchartlayout/".concat(e))})})).then((e=>{!function(e){pe=e}(e)})),he)}var ye,me;function fe(e,t,n,i,o,r){const a=n.length,s=o.length,l=Float64Array.BYTES_PER_ELEMENT,d=Uint32Array.BYTES_PER_ELEMENT,u=Uint8Array.BYTES_PER_ELEMENT,h=15+a*(u+2*l)+s*(2*d),p=pe._malloc(h);try{const u=p+16-p%16,h=u+a*l,c=h+a*l,y=c+s*d,m=y+s*d,f=()=>[pe.HEAPF64.subarray(u>>3,(u>>3)+a),pe.HEAPF64.subarray(h>>3,(h>>3)+a),pe.HEAPU32.subarray(c>>2,(c>>2)+s),pe.HEAPU32.subarray(y>>2,(y>>2)+s),pe.HEAPU8.subarray(m,m+a)],[g,v,w,b,x]=f();g.set(n),v.set(i),w.set(o),b.set(r),x.set(t);let _=e(a,m,u,h,s,c,y),M=null;if(_){const e=pe.getLayoutLinksTypes(),t=pe.getLayoutLinksVerticesEndIndices(),n=pe.getLayoutLinksVertices(),i=pe.countLayoutLinksVertices();!s||e&&t?i&&!n?_=!1:M={types:new Uint8Array(pe.HEAPU8.subarray(e,e+s)),vertexEndIndex:new Uint32Array(pe.HEAPU32.subarray(t>>2,(t>>2)+s)),vertices:new Float64Array(pe.HEAPF64.subarray(n>>3,(n>>3)+2*i))}:_=!1}const[T,L,I,E,C]=f();return n.set(T),i.set(L),o.set(I),r.set(E),t.set(C),{success:_,links:M}}finally{pe._free(p),pe.cleanupLayout()}}!function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot"}(ye||(ye={})),function(e){e[e.Regular=0]="Regular",e[e.Orthogonal=1]="Orthogonal",e[e.Curved=2]="Curved",e[e.Recursive=3]="Recursive"}(me||(me={}));var ge,ve,we,be,xe,_e,Me,Te;!function(e){e.getMinIdealEdgeLength=function(){return pe.getMinIdealEdgeLength()},e.apply=function(e,t,n,i,o){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1;return fe(((e,t,n,i,o,l,d)=>pe.applyForceDirectedLayout(e,t,n,i,o,l,d,r,a,s)),e,t,n,i,o)}}(ge||(ge={})),function(e){e.apply=function(e,t,n,i,o){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1;return fe(((e,t,n,i,o,l,d)=>pe.applyCommunityLayout(e,t,n,i,o,l,d,r,a,s)),e,t,n,i,o)}}(ve||(ve={})),function(e){e.apply=function(e,t,n,i,o){return fe(pe.applySimpleLayout,e,t,n,i,o)}}(we||(we={})),function(e){e.apply=function(e,t,n,i,o){return fe(pe.applyHierarchicalLayout,e,t,n,i,o)}}(be||(be={})),function(e){e.apply=function(e,t,n,i,o){return fe(pe.applyRadialTreeLayout,e,t,n,i,o)}}(xe||(xe={})),function(e){e.apply=function(e,t,n,i,o){return fe(pe.applySmartTreeLayout,e,t,n,i,o)}}(_e||(_e={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(Me||(Me={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(Te||(Te={}));var Le=n(46801),Ie=n(84252),Ee=n(13904);let Ce=class extends((0,$.d)((0,V.j)(h.A))){constructor(e){if(super(e),this.dataPreloadedInLocalCache=!1,this.defaultLinkChartConfig=null,this._currentLinkChartConfig={layoutMode:"RADIAL_TREE"},this._graphTypeLookup=new Map,this.dataManager=null,this.knowledgeGraph=null,this.layers=new o.A,this.entityLinkChartDiagramLookup=new Map,this.relationshipLinkChartDiagramLookup=new Map,this.linkChartExtent=new R.A({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7}),this.linkChartGeohashLookup=new Map,this.memberEntityTypes=null,this.memberRelationshipTypes=null,this.sublayerIdsCache=new Map,this.tables=new o.A,this.type="link-chart",this._originalInclusionList=e.inclusionModeDefinition,e.dataPreloadedInLocalCache&&!e.inclusionModeDefinition)throw new r.A("knowledge-graph:linkchart-layer-constructor","If creating a link chart composite layer and configured that data is already loaded in the cache, you must specify an inclusion list so the Composite Layer knows what records belong to it")}normalizeCtorArgs(e){return{url:e.url,title:e.title,dataPreloadedInLocalCache:e.dataPreloadedInLocalCache,defaultLinkChartConfig:e.defaultLinkChartConfig}}_initializeLayerProperties(e){var t,n,i,o,s,l,d,u,h,p;if(!this.title&&this.url){const e=this.url.split("/");this.title=e[e.length-2]}const c=new Set;let y=[],m=[];if(e.inclusionModeDefinition&&(!e.inclusionModeDefinition.namedTypeDefinitions||e.inclusionModeDefinition.namedTypeDefinitions.size<1))throw new r.A("knowledge-graph:composite-layer-constructor","If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined");null!==(t=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==t&&t.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)})),null!==(n=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==n&&n.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)})),null!==(i=e.inclusionModeDefinition)&&void 0!==i&&i.generateAllSublayers?(y=null!==(o=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==o?o:[],m=null!==(s=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==s?s:[]):null!==(l=e.inclusionModeDefinition)&&void 0!==l&&l.namedTypeDefinitions&&(null===(d=e.inclusionModeDefinition)||void 0===d?void 0:d.namedTypeDefinitions.size)>0?null===(u=e.inclusionModeDefinition)||void 0===u||u.namedTypeDefinitions.forEach(((t,n)=>{var i,o;if(!this._graphTypeLookup.get(n))return a.A.getLogger(this).warn("A named type, ".concat(n,", was in the inclusion list that wasn't in the data model and will be removed")),void(null===(i=e.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.delete(n));this._graphTypeLookup.get(n)instanceof Ie.A||"strictOrigin"in this._graphTypeLookup.get(n)?c.has(n)||(c.add(n),m.push(this._graphTypeLookup.get(n))):this._graphTypeLookup.get(n)instanceof Le.A||"properties"in this._graphTypeLookup.get(n)?c.has(n)||(c.add(n),y.push(this._graphTypeLookup.get(n))):(a.A.getLogger(this).warn("A named type, ".concat(n,", was in the inclusion list that wasn't properly modeled and will be removed")),null===(o=e.inclusionModeDefinition)||void 0===o||o.namedTypeDefinitions.delete(n))})):(y=null!==(h=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==h?h:[],m=null!==(p=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==p?p:[]);const f=new O({knowledgeGraph:e.knowledgeGraph,inclusionModeDefinition:e.inclusionModeDefinition});this.knowledgeGraph=e.knowledgeGraph,this.memberEntityTypes=y,this.memberRelationshipTypes=m,this.dataManager=f}load(e){return this.addResolvingPromise(new Promise((t=>{(0,T.fetchKnowledgeGraph)(this.url).then((n=>{var i,o,r,a;if(this._initializeLayerProperties({knowledgeGraph:n,inclusionModeDefinition:this._originalInclusionList}),null!==(i=this.dataManager.inclusionModeDefinition)&&void 0!==i&&null!==(i=i.namedTypeDefinitions)&&void 0!==i&&i.size||(this.dataManager.inclusionModeDefinition={generateAllSublayers:!1,namedTypeDefinitions:new Map},null!==(o=this.dataManager.knowledgeGraph.dataModel.entityTypes)&&void 0!==o&&o.forEach((e=>{var t;e.name&&(null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.set(e.name,{useAllData:!0}))})),null!==(r=this.dataManager.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==r&&r.forEach((e=>{var t;e.name&&(null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.set(e.name,{useAllData:!0}))}))),this.dataPreloadedInLocalCache)this.loadLayerAssumingLocalCache(),this.dataManager.inclusionModeDefinition&&(this.dataManager.inclusionModeDefinition.generateAllSublayers=!1),null===(a=this.dataManager.inclusionModeDefinition)||void 0===a||a.namedTypeDefinitions.forEach((e=>{var t;e.useAllData=!1,null!==(t=e.members)&&void 0!==t&&t.forEach((e=>{let t;t=e.linkChartLocation instanceof c.A?e.linkChartLocation:e.linkChartLocation?(0,p.Ux)(e.linkChartLocation):null,t&&2===t.coords.length&&0===t.lengths.length?(this.linkChartGeohashLookup.set(e.id,(0,u.Qj)(t.coords[1],t.coords[0],Z)),this.entityLinkChartDiagramLookup.set(e.id,t)):(this.linkChartGeohashLookup.set(e.id,""),this.relationshipLinkChartDiagramLookup.set(e.id,t))})),this.addResolvingPromise(this._initializeDiagram().then((async()=>{this.layers.forEach((async e=>{await e.refreshCachedQueryEngine()})),this.tables.forEach((async e=>{await e.refreshCachedQueryEngine()}))})))}));else{var l;const t="GEOGRAPHIC"===(null===(l=this.defaultLinkChartConfig)||void 0===l?void 0:l.layoutMode);this.addResolvingPromise(this.dataManager.refreshCacheContent(void 0,!1,t,!0).then((async()=>{(0,s.Te)(e);const t=[],n=[];this.loadLayerAssumingLocalCache(),this.dataManager.inclusionModeDefinition&&(this.dataManager.inclusionModeDefinition.generateAllSublayers=!1,this.dataManager.inclusionModeDefinition.namedTypeDefinitions.forEach((e=>{e.useAllData=!1}))),await this._initializeDiagram(),this.layers.forEach((e=>{n.push(e.refreshCachedQueryEngine()),t.push(new Promise((t=>{e.on("layerview-create",(()=>{t(null)}))})))})),this.tables.forEach((e=>{n.push(e.refreshCachedQueryEngine())})),await Promise.all(n)})))}t(null)}))}))),Promise.resolve(this)}async addRecords(e,t){let n=[];(null===t||void 0===t?void 0:t.cascadeAddRelationshipEndNodes)&&this.dataManager.knowledgeGraph.dataModel&&(n=await async function(e,t){var n;const i=[],o=new Map,r=[];if(null!==(n=t.dataModel)&&void 0!==n&&n.relationshipTypes)for(const s of t.dataModel.relationshipTypes)s.name&&o.set(s.name,[]);for(const s of e){var a;o.has(s.typeName)&&(null===(a=o.get(s.typeName))||void 0===a||a.push(s.id))}for(const[s,l]of o){if(l.length<1)continue;const e=new L.A({openCypherQuery:"MATCH (n)-[r:".concat(s,"]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]"),bindParameters:{ids:l}});r.push((0,T.executeQueryStreaming)(t,e).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:n}=await t.read();if(e)break;for(const t of n)i.push({id:t[0],typeName:t[1]}),i.push({id:t[2],typeName:t[3]})}})))}return await Promise.all(r),i}(e,this.dataManager.knowledgeGraph));const i=e.concat(n).filter((e=>{var t;return!(null!==(t=this.sublayerIdsCache.get(e.typeName))&&void 0!==t&&t.has(e.id))}));await this._handleNewRecords(i)}async removeRecords(e){let{cascadeRemoveRelationships:t=!0,recalculateLayout:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{cascadeRemoveRelationships:!0,recalculateLayout:!1},i=[];for(const l of e){var o,r;!1===(null===(o=this.dataManager.inclusionModeDefinition)||void 0===o||null===(o=o.namedTypeDefinitions)||void 0===o||null===(o=o.get(l.typeName))||void 0===o?void 0:o.useAllData)&&(null===(r=this.dataManager.inclusionModeDefinition)||void 0===r||null===(r=r.namedTypeDefinitions)||void 0===r||null===(r=r.get(l.typeName))||void 0===r||null===(r=r.members)||void 0===r?void 0:r.has(l.id))&&i.push(l)}if(t){const e=new Set,t=[];for(const n of i)if(this.dataManager.nodeConnectionsLookup.has(n.id))for(const t of this.dataManager.nodeConnectionsLookup.get(n.id))e.add(t);for(const n of e)if(this.dataManager.memberIdTypeLookup.has(n))for(const e of this.dataManager.memberIdTypeLookup.get(n))this.dataManager.relationshipTypeNames.has(e)&&t.push({id:n,typeName:e});i=i.concat(t)}this.dataManager.removeFromLayer(i);for(const l of i){var a;null!==(a=this.sublayerIdsCache.get(l.typeName))&&void 0!==a&&a.delete(l.id),this.dataManager.relationshipTypeNames.has(l.typeName)?this.relationshipLinkChartDiagramLookup.delete(l.id):this.entityLinkChartDiagramLookup.delete(l.id)}n&&await this.calculateLinkChartLayout(this._currentLinkChartConfig.layoutMode,{});const s=[];return this.layers.forEach((e=>{s.push(e.refreshCachedQueryEngine())})),await Promise.all(s),this._refreshNamedTypes(),i}async expand(e,t){const n=await this.dataManager.getConnectedRecordIds(e,t),i=n.filter((e=>{var t;return!(null!==(t=this.sublayerIdsCache.get(e.typeName))&&void 0!==t&&t.has(e.id))}));return await this._handleNewRecords(n),{records:i}}loadLayerAssumingLocalCache(){var e,t;this.memberRelationshipTypes.forEach((e=>{const t=new de({objectType:e,parentCompositeLayer:this,graphType:"relationship",title:e.name});t.geometryType?this.layers.push(t):this.tables.push(t),this.dataManager.sublayerCaches.has(e.name)||this.dataManager.sublayerCaches.set(e.name,new Map)})),this.memberEntityTypes.forEach((e=>{const t=new de({objectType:e,parentCompositeLayer:this,graphType:"entity",title:e.name});t.geometryType?this.layers.push(t):this.tables.push(t),this.dataManager.sublayerCaches.has(e.name)||this.dataManager.sublayerCaches.set(e.name,new Map)})),(null===(e=this.dataManager.inclusionModeDefinition)||void 0===e?void 0:e.namedTypeDefinitions)&&(null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.forEach(((e,t)=>{var n;const i=((e,t,n)=>(e.has(t)||e.set(t,n()),e.get(t)))(this.sublayerIdsCache,t,(()=>new Set));null===(n=e.members)||void 0===n||n.forEach((e=>{if(i.add(e.id),e.linkChartLocation)if(e.linkChartLocation instanceof c.A)this.dataManager.relationshipTypeNames.has(t)?this.relationshipLinkChartDiagramLookup.set(e.id,e.linkChartLocation):this.entityLinkChartDiagramLookup.set(e.id,e.linkChartLocation),2===e.linkChartLocation.coords.length&&0===e.linkChartLocation.lengths.length?this.linkChartGeohashLookup.set(e.id,(0,u.Qj)(e.linkChartLocation.coords[1],e.linkChartLocation.coords[0],Z)):this.linkChartGeohashLookup.set(e.id,"");else{const n=(0,p.Ux)(e.linkChartLocation);this.dataManager.relationshipTypeNames.has(t)?this.relationshipLinkChartDiagramLookup.set(e.id,e.linkChartLocation?n:null):this.entityLinkChartDiagramLookup.set(e.id,e.linkChartLocation?n:null),"x"in e.linkChartLocation&&"y"in e.linkChartLocation?this.linkChartGeohashLookup.set(e.id,(0,u.Qj)(e.linkChartLocation.x,e.linkChartLocation.y,Z)):this.linkChartGeohashLookup.set(e.id,"")}}))})))}async calculateLinkChartLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"RADIAL_TREE",t=arguments.length>1?arguments[1]:void 0;const n=[],i=[],o=[];this.dataManager.sublayerCaches.forEach(((e,t)=>{this.dataManager.entityTypeNames.has(t)?e.forEach((e=>{n.push({typeName:t,feature:e})})):this.dataManager.relationshipTypeNames.has(t)&&e.forEach((e=>{i.push({typeName:t,feature:e})}))})),this.entityLinkChartDiagramLookup=new Map,this.relationshipLinkChartDiagramLookup=new Map;const s=new Map,l=new Map,d=new Map,h=new Map,c=new Uint8Array(n.length),y=new Float64Array(n.length),m=new Float64Array(n.length),f=new Uint32Array(i.length),g=new Uint32Array(i.length),v=[],w=new R.A({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7});let b,x="FORCE_DIRECTED",_=0,M=0;switch(x="GEOGRAPHIC"===e?"FORCE_DIRECTED":e,x){case"FORCE_DIRECTED":b=ge.apply;break;case"COMMUNITY":b=ve.apply;break;case"HIERARCHICAL":b=be.apply;break;case"RADIAL_TREE":b=xe.apply;break;case"SMART_TREE":b=_e.apply;break;default:b=we.apply}n.forEach((n=>{var i,o,r,a,s,l;let{typeName:d,feature:u}=n;if(null!==t&&void 0!==t&&null!==(i=t.lockedNodeLocations)&&void 0!==i&&i.has(u.attributes[j])){"GEOGRAPHIC"===e&&this.dataManager.geographicLookup.has(d)?c[_]=ye.IsGeographic:c[_]=ye.None;const n=t.lockedNodeLocations.get(u.attributes[j]);y[_]=n.x,m[_]=n.y}else if("GEOGRAPHIC"===e&&this.dataManager.geographicLookup.has(d)){var p;c[_]=ye.IsGeographic;let e=null;const t=u.attributes[this.dataManager.geographicLookup.get(d).name];switch(null===(p=this.dataManager.geographicLookup.get(d))||void 0===p?void 0:p.geometryType){case"esriGeometryPoint":y[_]=null===t||void 0===t?void 0:t.x,m[_]=null===t||void 0===t?void 0:t.y;break;case"esriGeometryPolygon":e=null===t||void 0===t?void 0:t.centroid,null!=(null===(o=e)||void 0===o?void 0:o.x)&&null!=(null===(r=e)||void 0===r?void 0:r.y)?(y[_]=e.x,m[_]=e.y):c[_]=ye.IsMovable;break;case"esriGeometryPolyline":case"esriGeometryMultipoint":e=null===t||void 0===t||null===(a=t.extent)||void 0===a?void 0:a.center,null!=(null===(s=e)||void 0===s?void 0:s.x)&&null!=(null===(l=e)||void 0===l?void 0:l.y)?(y[_]=e.x,m[_]=e.y):c[_]=ye.IsMovable;break;default:c[_]=ye.IsMovable}(null==y[_]||null==m[_]||Number.isNaN(y[_])||Number.isNaN(m[_]))&&(c[_]=ye.IsMovable,y[_]=0,m[_]=0)}else c[_]=ye.IsMovable,y[_]=0,m[_]=0;h.set(u.attributes[j],_),v[_]={feature:u,typeName:d},_++}));let T=!1;const L=new Map;i.forEach((e=>{const t=e.feature.attributes[B],n=e.feature.attributes[P],i=h.get(t),r=h.get(n);if(void 0!==i&&void 0!==r){const a=t+"-"+n,s=L.get(a);(null===s||void 0===s?void 0:s.has(e.typeName))||(f[M]=i,g[M]=r,void 0===s?L.set(a,new Map([[e.typeName,M]])):s.set(e.typeName,M),M++),o.push(e)}else T=!0,this.relationshipLinkChartDiagramLookup.set(t,null),this.linkChartGeohashLookup.set(t,null)})),T&&a.A.getLogger(this).warn("A relationship is a member of this layer that has either origin or destination entity nodes that are not members. The diagram geometry will be set to null"),await ce();const{success:I,links:E}=b(c,y,m,f.subarray(0,M),g.subarray(0,M));if(!I)throw new r.A("knowledge-graph:layout-failed","Attempting to arrange the records in the specified layout failed");for(let r=0;r<v.length;r++){if(m[r]>84.9999?m[r]=84.9999:m[r]<-84.9999&&(m[r]=-84.9999),y[r]>179.9999?y[r]=179.9999:y[r]<-179.9999&&(y[r]=-179.9999),v[r].feature.attributes[G]=new Ee.A(y[r],m[r]),s.has(v[r].typeName)){const e=s.get(v[r].typeName);null===e||void 0===e||e.set(v[r].feature.attributes[j],v[r].feature)}else{const e=new Map;e.set(v[r].feature.attributes[j],v[r].feature),s.set(v[r].typeName,e)}d.set(v[r].feature.attributes[j],v[r].feature);const e=(0,p.Ux)(v[r].feature.attributes[G]);this.entityLinkChartDiagramLookup.set(v[r].feature.attributes[j],v[r].feature.attributes[G]?e:null),this.linkChartGeohashLookup.set(v[r].feature.attributes[j],(0,u.Qj)(v[r].feature.attributes[G].y,v[r].feature.attributes[G].x,Z)),v[r].feature.attributes[G].x<w.xmin&&(w.xmin=v[r].feature.attributes[G].x),v[r].feature.attributes[G].x>w.xmax&&(w.xmax=v[r].feature.attributes[G].x),v[r].feature.attributes[G].y<w.ymin&&(w.ymin=v[r].feature.attributes[G].y),v[r].feature.attributes[G].y>w.ymax&&(w.ymax=v[r].feature.attributes[G].y)}if(this.linkChartExtent.xmin=w.xmin,this.linkChartExtent.xmax=w.xmax,this.linkChartExtent.ymin=w.ymin,this.linkChartExtent.ymax=w.ymax,!E)throw new r.A("knowledge-graph:layout-failed","Attempting to retrieve link geometry from diagram engine failed");const C=new Map,S=new Map,k=new Map,A=new Set;for(let r=0;r<o.length;r++){const e=[],t=o[r],n=t.feature.attributes[B],i=t.feature.attributes[P],s=n+"-"+i,u=L.get(s).get(t.typeName),c=0===u?0:null===E||void 0===E?void 0:E.vertexEndIndex[u-1];if(!A.has(u)){var N,D;if(A.add(u),E.types[u]===me.Recursive){const t=[E.vertices[2*c],E.vertices[2*c+1]],n=[E.vertices[2*(c+1)],E.vertices[2*(c+1)+1]],i=[.5*(t[0]+n[0]),.5*(t[1]+n[1])],o=[i[0]-t[0],i[1]-t[1]],r=[i[0]+o[1],i[1]-o[0]],a=[i[0]-o[1],i[1]+o[0]];e.push(t),e.push(r),e.push(n),e.push(a),e.push(t)}else{if(E.types[u]!==me.Regular){a.A.getLogger(this).warn("A relationship generated an unsupported link geometry type.  It will not be rendered");continue}for(let t=c;t<E.vertexEndIndex[u];t++)e.push([E.vertices[2*t],E.vertices[2*t+1]])}const t=null===(N=v[h.get(n)])||void 0===N?void 0:N.feature.attributes[G],o=null===(D=v[h.get(i)])||void 0===D?void 0:D.feature.attributes[G];e[0][0]===t.x&&e[0][1]===t.y||(e[0]=[t.x,t.y]),e[e.length-1][0]===o.x&&e[e.length-1][1]===o.y||(e[e.length-1]=[o.x,o.y]);for(let n=1;n<e.length-1;n++)e[n][1]>85.5?e[n][1]=85.5:e[n][1]<-85.5&&(e[n][1]=-85.5),e[n][0]>179.9999?e[n][0]=179.9999:e[n][0]<-179.9999&&(e[n][0]=-179.9999);C.has(s)?C.get(s).push(e):C.set(s,[e])}const y=C.get(s);S.has(s)||(S.set(s,new Map),k.set(s,new Map));const m=S.get(s),f=k.get(s);m.has(t.typeName)||(m.set(t.typeName,y.shift()),f.set(t.typeName,0));const g=m.get(t.typeName);f.set(t.typeName,f.get(t.typeName)+1);const w=new ae.A({paths:g});if(t.feature.attributes[G]=w,l.has(t.typeName)){const e=l.get(t.typeName);null===e||void 0===e||e.set(t.feature.attributes[j],t.feature)}else{const e=new Map;e.set(t.feature.attributes[j],t.feature),l.set(t.typeName,e)}d.set(t.feature.attributes[j],t.feature);const b=(0,p.Ux)(t.feature.attributes[G]);this.relationshipLinkChartDiagramLookup.set(t.feature.attributes[j],t.feature.attributes[G]?b:null),this.linkChartGeohashLookup.set(t.feature.attributes[j],"")}for(const r of o){var O,q;r.feature.attributes[F]=null!==(O=null===(q=k.get(r.feature.attributes[B]+"-"+r.feature.attributes[P]))||void 0===q?void 0:q.get(r.typeName))&&void 0!==O?O:null}return this._currentLinkChartConfig={layoutMode:e},{nodes:s,links:l,idMap:d}}async applyNewLinkChartLayout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"RADIAL_TREE",t=arguments.length>1?arguments[1]:void 0;const n=[];await this.calculateLinkChartLayout(e,t),this.layers.forEach((e=>{n.push(e.refreshCachedQueryEngine())})),await Promise.all(n),this._refreshNamedTypes()}getCurrentNodeLocations(){var e;const t=new Map;return null!==(e=this.dataManager.inclusionModeDefinition)&&void 0!==e&&null!==(e=e.namedTypeDefinitions)&&void 0!==e&&e.forEach((e=>{var n;null===e||void 0===e||null===(n=e.members)||void 0===n||n.forEach((e=>{const n=e.linkChartLocation;let i;const o=e.id;n&&(i="x"in n?{x:n.x,y:n.y}:{x:n.coords[0],y:n.coords[1]},t.set(o,new Ee.A({x:i.x,y:i.y})))}))})),t}async synchronizeInclusionListWithCache(){return new Promise((e=>{var t;null!==(t=this.dataManager.inclusionModeDefinition)&&void 0!==t&&t.namedTypeDefinitions.forEach(((e,t)=>{if(e.useAllData=!1,e.members&&e.members.size>0){if(!this.dataManager.sublayerCaches.get(t))return;const n=new Set(Array.from(this.dataManager.sublayerCaches.get(t).keys()));Array.from(e.members.keys()).filter((e=>!n.has(e))).forEach((t=>{var n;null===(n=e.members)||void 0===n||n.delete(t)}))}})),e()}))}async refreshLinkChartCache(e){await this.dataManager.refreshCacheContent(e);const t=[];this.layers.forEach((e=>{t.push(e.refreshCachedQueryEngine())})),await Promise.all(t),this._refreshNamedTypes()}async _handleNewRecords(e){const t=[];this.dataManager.addToLayer(e);for(const n of e)this.sublayerIdsCache.has(n.typeName)||(this.sublayerIdsCache.set(n.typeName,new Set),t.push(n.typeName)),this.sublayerIdsCache.get(n.typeName).add(n.id);for(const n of t)if(this._graphTypeLookup.has(n)){const e=this._graphTypeLookup.get(n),t="endPoints"in e?"relationship":"entity",i=new de({objectType:e,parentCompositeLayer:this,graphType:t,title:n});"entity"===t?this.dataManager.entityTypeNames.add(n):this.dataManager.relationshipTypeNames.add(n),i.geometryType?this.layers.push(i):this.tables.push(i),this.dataManager.sublayerCaches.set(n,new Map)}await this.dataManager.refreshCacheContent(e.map((e=>e.id))),await this.applyNewLinkChartLayout(this._currentLinkChartConfig.layoutMode)}async _initializeDiagram(){var e;this.defaultLinkChartConfig?this.defaultLinkChartConfig.doNotRecalculateLayout?(null!==(e=this.dataManager.inclusionModeDefinition)&&void 0!==e&&null!==(e=e.namedTypeDefinitions)&&void 0!==e&&e.forEach(((e,t)=>{var n;null===e||void 0===e||null===(n=e.members)||void 0===n||n.forEach((e=>{const n=e.linkChartLocation;let i;const o=e.id;if(!n)return;i="x"in n?{x:n.x,y:n.y}:{x:n.coords[0],y:n.coords[1]};const r=(0,p.Ux)(i);this.dataManager.relationshipTypeNames.has(t)?this.relationshipLinkChartDiagramLookup.set(o,r):this.entityLinkChartDiagramLookup.set(o,r),this.linkChartGeohashLookup.set(o,(0,u.Qj)(i.x,i.y,Z)),this.linkChartExtent.xmin>i.x&&(this.linkChartExtent.xmin=i.x),this.linkChartExtent.xmax<i.x&&(this.linkChartExtent.xmax=i.x),this.linkChartExtent.ymin>i.y&&(this.linkChartExtent.ymin=i.y),this.linkChartExtent.ymax<i.y&&(this.linkChartExtent.ymax=i.y)}))})),this.memberRelationshipTypes.forEach((e=>{var t;e.name&&(null===(t=this.dataManager.sublayerCaches.get(e.name))||void 0===t||t.forEach((e=>{const t=this.relationshipLinkChartDiagramLookup.get(e.attributes[B]),n=this.relationshipLinkChartDiagramLookup.get(e.attributes[P]);if(t&&n){const i=(0,p.Ux)(new ae.A({paths:[[t.coords[0],t.coords[1]],[n.coords[0],n.coords[1]]]}));this.relationshipLinkChartDiagramLookup.set(e.attributes[j],i)}else this.relationshipLinkChartDiagramLookup.set(e.attributes[j],null);this.linkChartGeohashLookup.set(e.attributes[j],"")})))}))):await this.calculateLinkChartLayout(this.defaultLinkChartConfig.layoutMode,{lockedNodeLocations:this.getCurrentNodeLocations()}):await this.calculateLinkChartLayout("RADIAL_TREE",{lockedNodeLocations:this.getCurrentNodeLocations()})}_refreshNamedTypes(){for(const e of this.layers)e.emit("refresh",{dataChanged:!0});for(const e of this.tables)e.emit("refresh",{dataChanged:!0})}};(0,i._)([(0,l.MZ)()],Ce.prototype,"dataPreloadedInLocalCache",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"defaultLinkChartConfig",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"dataManager",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"knowledgeGraph",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"layers",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"entityLinkChartDiagramLookup",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"relationshipLinkChartDiagramLookup",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"linkChartExtent",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"linkChartGeohashLookup",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"memberEntityTypes",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"memberRelationshipTypes",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"sublayerIdsCache",void 0),(0,i._)([(0,l.MZ)()],Ce.prototype,"tables",void 0),(0,i._)([(0,l.MZ)({json:{read:!1}})],Ce.prototype,"type",void 0),Ce=(0,i._)([(0,d.$)("esri.layers.LinkChartLayer")],Ce);const Se=Ce},44081:(e,t,n)=>{n.d(t,{LF:()=>s,M9:()=>l,zu:()=>d});var i=n(50076),o=n(48611),r=n(7847),a=n(58503);function s(e,t,n){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const n of e)t.push({scale:n.scale,value:d(n.value)});return t}return d(e)}(e)}catch(o){var i;null===n||void 0===n||null===(i=n.messages)||void 0===i||i.push(o)}return null}function l(e,t,n,i){try{const i=function(e){const t=(0,r.q)(e);return t?(0,a.dw)(t)?t.map((e=>e.toJSON())):t.map((e=>{let{scale:t,effects:n}=e;return{scale:t,value:n.map((e=>e.toJSON()))}})):null}(e);(0,o.sM)(n,i,t)}catch(l){i.messages&&i.messages.push(l)}}function d(e){if(null===e||void 0===e||!e.length)return"";const t=[];for(const n of e){let e=[];switch(n.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[u(n,"amount")];break;case"blur":e=[u(n,"radius","pt")];break;case"hue-rotate":e=[u(n,"angle","deg")];break;case"drop-shadow":e=[u(n,"xoffset","pt"),u(n,"yoffset","pt"),u(n,"blurRadius","pt"),h(n,"color")];break;case"bloom":e=[u(n,"strength"),u(n,"radius","pt"),u(n,"threshold")]}const i="".concat(n.type,"(").concat(e.filter(Boolean).join(" "),")");(0,r.q)(i),t.push(i)}return t.join(" ")}function u(e,t,n){if(null==e[t])throw new i.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});return n?e[t]+n:""+e[t]}function h(e,t){if(null==e[t])throw new i.A("effect:missing-parameter","Missing parameter '".concat(t,"' in ").concat(e.type," effect"),{effect:e});const n=e[t];return"rgba(".concat(n[0]||0,", ").concat(n[1]||0,", ").concat(n[2]||0,", ").concat(n[3]/255||0,")")}},33328:(e,t,n)=>{n.d(t,{F:()=>l});var i=n(81806),o=n(70373),r=n(2413);const a={minX:0,minY:0,maxX:0,maxY:0};function s(e,t,n){(function(e){a.minX=e[0],a.minY=e[1],a.maxX=e[2],a.maxY=e[3]})(t),e.search(a,n)}class l{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new o.w(9,(0,i.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((n,i)=>{e[t++]=i})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,r.Ie)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),s(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},72547:(e,t,n)=>{n.d(t,{A:()=>y});var i=n(18690),o=n(50076),r=n(54099),a=n(76460),s=n(42294),l=n(2413),d=n(98618),u=n(33328),h=n(55167),p=n(33376);const c=(0,s.vt)();class y{constructor(e){this.geometryInfo=e,this._boundsStore=new u.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new r.A,this.featureAdapter=p.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,n,i,o]=this.fullBounds;return{xmin:t,ymin:n,xmax:i,ymax:o,spatialReference:(0,h.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(i.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const n of e){const e=this._boundsStore.get(n.objectId);e&&t((0,s.Jt)(c,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let e=!1;this._featuresById.forEach(((t,n)=>{this._markedIds.has(n)||(e=!0,this._remove(t))})),this._markedIds.clear(),e&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(e){var t;if(!e)return;const n=e.objectId;if(null==n)return void a.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.A("featurestore:invalid-feature","feature id is missing",{feature:e}));const i=this._featuresById.get(n);let r;if(this._markedIds.add(n),i?(e.displayId=i.displayId,r=this._boundsStore.get(n),this._boundsStore.delete(n)):null!=this.onFeatureAdd&&this.onFeatureAdd(e),null===(t=e.geometry)||void 0===t||null===(t=t.coords)||void 0===t||!t.length)return this._boundsStore.set(n,null),void this._featuresById.set(n,e);r=(0,d.jQ)(null!=r?r:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=r&&this._boundsStore.set(n,r),this._featuresById.set(n,e)}_upsert(e){var t;const n=null===e||void 0===e?void 0:e.objectId;if(null==n)return a.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const i=this._featuresById.get(n);if(!i)return this._add(e),e;this._markedIds.add(n);const{geometry:r,attributes:s}=e;for(const o in s)i.attributes[o]=s[o];return r&&(i.geometry=r,this._boundsStore.set(n,null!==(t=(0,d.jQ)((0,l.vt)(),r,this.geometryInfo.hasZ,this.geometryInfo.hasM))&&void 0!==t?t:null)),i}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._markedIds.delete(t),this._boundsStore.delete(t),this._featuresById.delete(t),e}}},40296:(e,t,n)=>{n.d(t,{F0:()=>s,Vx:()=>u,e2:()=>h,f:()=>p});var i=n(81806),o=n(53084),r=n(8298),a=n(44460);function s(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?a.Cb:"esriGeometryPolyline"===e?a.yM:a.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let d=1;function u(e,t){if((0,i.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n="this.".concat(t," = null;");for(const t in e)n+="this".concat(l.test(t)?".".concat(t):'["'.concat(t,'"]')," = ").concat(JSON.stringify(e[t]),";");const i=new Function("\n      return class AttributesClass$".concat(d++," {\n        constructor() {\n          ").concat(n,";\n        }\n      }\n    "))();return()=>new i}catch(n){return()=>({[t]:null,...e})}}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,o.o8)(e)}}]}function p(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:r.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},65624:(e,t,n)=>{n.d(t,{d:()=>l});var i=n(35143),o=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),a=n(44081);const s={read:{reader:a.LF},write:{allowNull:!0,writer:a.M9}},l=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,i._)([(0,o.MZ)({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),(0,i._)([(0,o.MZ)({json:{read:!1,write:!1,origins:{"web-map":s,"portal-item":s}}})],t.prototype,"effect",void 0),t=(0,i._)([(0,r.$)("esri.layers.mixins.BlendLayer")],t),t}},21617:(e,t,n)=>{n.d(t,{J:()=>b});var i=n(35143),o=n(76460),r=n(50346),a=n(46053),s=n(21403),l=(n(47249),n(81806),n(85842)),d=n(80979),u=n(94643),h=(n(98773),n(50076),n(68452),n(49281));const p=new u.A,c=new WeakMap;function y(e){m(e)&&p.push(new WeakRef(e))}function m(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function f(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:f(t,e%t):0}let g=0,v=0;function w(){const e=Date.now();let t=!1;for(const i of p){const o=i.deref();var n;if(o){if(o.refreshInterval)e-(null!==(n=c.get(o))&&void 0!==n?n:0)+5>=6e4*o.refreshInterval&&(c.set(o,e),o.refresh(e))}else t=!0}if(t)for(let i=p.length-1;i>=0;i--)p.at(i).deref()||p.removeAt(i)}(0,h.fm)((()=>{const e=Date.now();let t=0;for(const n of p){const i=n.deref();i&&(t=f(Math.round(6e4*i.refreshInterval),t),i.refreshInterval?c.get(i)||c.set(i,e):c.delete(i))}if(t!==v){if(v=t,clearInterval(g),0===v)return void(g=0);g=setInterval(w,v)}}));const b=e=>{let t=class extends e{constructor(){super(...arguments),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,r.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||y(this)}),(()=>{}))}destroy(){!function(e){const t=p.find((t=>t.deref()===e));t&&p.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();(0,r.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{o.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){const e=this;return{set refreshInterval(t){e._set("refreshInterval",t)}}}};return(0,i._)([(0,a.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:d.K}}}}})],t.prototype,"refreshInterval",void 0),(0,i._)([(0,s.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,i._)([(0,a.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,i._)([(0,a.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,i._)([(0,l.$)("esri.layers.mixins.RefreshableLayer")],t),t}},5682:(e,t,n)=>{n.d(t,{j:()=>a});var i=n(35143),o=n(46053),r=(n(81806),n(76460),n(47249),n(85842));const a=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const e={minScale:this.minScale,maxScale:this.maxScale},t=this.parent;t&&"effectiveScaleRange"in t&&function(e,t){e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale}(e,t.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===e.minScale&&n.maxScale===e.maxScale?n:e}};return(0,i._)([(0,o.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),(0,i._)([(0,o.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),(0,i._)([(0,o.MZ)({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=(0,i._)([(0,r.$)("esri.layers.mixins.ScaleRangeLayer")],t),t}},71401:(e,t,n)=>{n.d(t,{A:()=>I});var i,o=n(35143),r=n(95444),a=n(45802),s=n(42553),l=n(53084),d=n(76931),u=n(46053),h=(n(81806),n(76460),n(28379)),p=n(85842),c=n(17707),y=(n(47249),n(65460));let m=i=class extends s.oY{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,t){return t.value?(0,y.mX)(t.value):e}writeExpression(e,t,n){null!=this.value&&(e=(0,y.mX)(this.value)),null!=e&&(t[n]=e)}clone(){return new i({expression:this.expression,title:this.title,value:this.value})}};(0,o._)([(0,u.MZ)({type:String,json:{write:{writerEnsuresNonNull:!0}}})],m.prototype,"expression",void 0),(0,o._)([(0,h.w)("expression",["expression","value"])],m.prototype,"readExpression",null),(0,o._)([(0,c.K)("expression")],m.prototype,"writeExpression",null),(0,o._)([(0,u.MZ)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],m.prototype,"title",void 0),(0,o._)([(0,u.MZ)({json:{read:!1,write:!1}})],m.prototype,"value",void 0),m=i=(0,o._)([(0,p.$)("esri.layers.support.LabelExpressionInfo")],m);const f=m;var g,v=n(31933),w=n(84202),b=n(9192);const x=new a.J({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function _(e,t,n){return{enabled:!(0,v.TU)(null===n||void 0===n?void 0:n.layer)}}function M(e){var t;return!e||"service"!==e.origin&&!("map-image"===(null===(t=e.layer)||void 0===t?void 0:t.type))}function T(e){var t;return!!function(e){return"map-image"===(null===e||void 0===e?void 0:e.type)}(e)&&!(null===(t=e.capabilities)||void 0===t||null===(t=t.exportMap)||void 0===t||!t.supportsArcadeExpressionForLabeling)}let L=g=class extends s.oY{static evaluateWhere(e,t){const n=(e,t,n)=>{switch(t){case"=":return e==n;case"<>":return e!=n;case">":return e>n;case">=":return e>=n;case"<":return e<n;case"<=":return e<=n}return!1};try{if(null==e)return!0;const i=e.split(" ");if(3===i.length)return n(t[i[0]],i[1],i[2]);if(7===i.length){const e=n(t[i[0]],i[1],i[2]),o=i[3],r=n(t[i[4]],i[5],i[6]);switch(o){case"AND":return e&&r;case"OR":return e||r}}return!1}catch(i){console.log("Error.: can't parse = "+e)}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=w.Hk,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,t){const n=t.labelExpressionInfo;if(!n||!n.value&&!n.expression)return e}writeLabelExpression(e,t,n){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)e=(0,y.D3)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const t=(0,y.tH)(this.labelExpressionInfo.expression);t&&(e="["+t+"]")}null!=e&&(t[n]=e)}writeLabelExpressionInfo(e,t,n,i){if(null==e&&null!=this.labelExpression&&M(i))e=new f({expression:this.getLabelExpressionArcade()});else if(!e)return;const o=e.toJSON(i);o.expression&&(t[n]=o)}writeMaxScale(e,t){(e||this.minScale)&&(t.maxScale=e)}writeMinScale(e,t){(e||this.maxScale)&&(t.minScale=e)}getLabelExpression(){return(0,y.XJ)(this)}getLabelExpressionArcade(){return(0,y.BI)(this)}getLabelExpressionSingleField(){return(0,y.rU)(this)}hash(){return JSON.stringify(this)}clone(){return new g({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:(0,l.o8)(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:(0,l.o8)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};(0,o._)([(0,u.MZ)({type:String,json:{write:!0}})],L.prototype,"name",void 0),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:_}}}}})],L.prototype,"allowOverrun",void 0),(0,o._)([(0,u.MZ)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:_}}}}})],L.prototype,"deconflictionStrategy",void 0),(0,o._)([(0,u.MZ)({type:String,json:{write:{overridePolicy(e,t,n){return this.labelExpressionInfo&&"service"===(null===n||void 0===n?void 0:n.origin)&&T(n.layer)?{enabled:!1}:{allowNull:!0}}}}})],L.prototype,"labelExpression",void 0),(0,o._)([(0,h.w)("labelExpression")],L.prototype,"readLabelExpression",null),(0,o._)([(0,c.K)("labelExpression")],L.prototype,"writeLabelExpression",null),(0,o._)([(0,u.MZ)({type:f,json:{write:{overridePolicy:(e,t,n)=>function(e){return M(e)||T(null===e||void 0===e?void 0:e.layer)}(n)?{allowNull:!0}:{enabled:!1}}}})],L.prototype,"labelExpressionInfo",void 0),(0,o._)([(0,c.K)("labelExpressionInfo")],L.prototype,"writeLabelExpressionInfo",null),(0,o._)([(0,u.MZ)({type:x.apiValues,json:{type:x.jsonValues,read:x.read,write:x.write}})],L.prototype,"labelPlacement",void 0),(0,o._)([(0,u.MZ)({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],L.prototype,"labelPosition",void 0),(0,o._)([(0,u.MZ)({type:Number})],L.prototype,"maxScale",void 0),(0,o._)([(0,c.K)("maxScale")],L.prototype,"writeMaxScale",null),(0,o._)([(0,u.MZ)({type:Number})],L.prototype,"minScale",void 0),(0,o._)([(0,c.K)("minScale")],L.prototype,"writeMinScale",null),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:_}}}}})],L.prototype,"repeatLabel",void 0),(0,o._)([(0,u.MZ)({type:Number,cast:d.cr,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:_}}}}})],L.prototype,"repeatLabelDistance",void 0),(0,o._)([(0,u.MZ)({types:r.em,json:{origins:{"web-scene":{types:r.Rv,write:b.oO,default:null}},write:b.oO,default:null}})],L.prototype,"symbol",void 0),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],L.prototype,"useCodedValues",void 0),(0,o._)([(0,u.MZ)({type:String,json:{write:!0}})],L.prototype,"where",void 0),L=g=(0,o._)([(0,p.$)("esri.layers.support.LabelClass")],L);const I=L},55053:(e,t,n)=>{n.d(t,{ui:()=>x,Yj:()=>f,id:()=>M,kF:()=>c,fV:()=>m,C1:()=>I,hG:()=>L,hn:()=>T,ke:()=>w,Ih:()=>b,M6:()=>p,Qo:()=>g,Fm:()=>_,PY:()=>h,OZ:()=>y});var i=n(82111),o=n(80979),r=n(76797),a=n(13312),s=n(79453),l=(n(18690),n(53084),n(18288));var d=n(731),u=n(2183);const h={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:o.K}}},p={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,n){t[n]=!e}}}},c={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:o.K}}},y={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:s.w}}},m={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:o.K}}},f={value:null,type:d.A,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:o.K}}};function g(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const v={write:{enabled:!0,layerContainerTypes:o.K},read:!0},w={type:Number,json:{origins:{"web-document":v,"portal-item":{write:!0}}}},b={...w,json:{...w.json,origins:{"web-document":{...v,write:{enabled:!0,layerContainerTypes:o.K,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,n)=>{var i;return n&&"service"!==n.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?null!==(i=t.layerDefinition)&&void 0!==i&&i.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?(0,u.D)(t.layerDefinition.drawingInfo.transparency):void 0:(0,u.D)(t.drawingInfo.transparency)}}}},x={type:i.A,readOnly:!0,get(){var e,t,n;const o=null!=(null===(e=this.layer)||void 0===e?void 0:e.timeInfo)?this.layer:null!=(null===(t=this.i3slayer)||void 0===t?void 0:t.timeInfo)?this.i3slayer:null;if(null==o)return null;const{datesInUnknownTimezone:r,timeOffset:a,useViewTime:s}=o,d=null===(n=this.view)||void 0===n?void 0:n.timeExtent;let u=o.timeExtent;r&&(u=function(e){if(!e)return e;const{start:t,end:n}=e;return new i.A({start:null!=t?(0,l.S1)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,l.S1)(n,n.getTimezoneOffset(),"minutes"):n})}(u));let h=s?d&&u?d.intersection(u):d||u:u;if(!h||h.isEmpty||h.isAllTime)return h;a&&(h=h.offset(-a.value,a.unit)),r&&(h=function(e){if(!e)return e;const{start:t,end:n}=e;return new i.A({start:null!=t?(0,l.S1)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,l.S1)(n,-n.getTimezoneOffset(),"minutes"):n})}(h));const p=this._get("timeExtent");return h.equals(p)?p:h}},_={type:r.A,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const n=r.A.fromJSON(e);return null!=t.spatialReference&&"object"==typeof t.spatialReference&&(n.spatialReference=a.A.fromJSON(t.spatialReference)),n}}}},read:!1}},M={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},T={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:o.K}}},name:"layerDefinition.minScale",write:!0}},L={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:o.K}}},name:"layerDefinition.maxScale",write:!0}},I={json:{write:{ignoreOrigin:!0,layerContainerTypes:o.K},origins:{"web-map":{read:!1,write:!1}}}}},65460:(e,t,n)=>{n.d(t,{BI:()=>f,D3:()=>y,XJ:()=>m,lc:()=>c,mX:()=>v,rU:()=>g,tH:()=>M});var i=n(88685);const o="__begin__",r="__end__",a=new RegExp(o,"ig"),s=new RegExp(r,"ig"),l=new RegExp("^"+o,"i"),d=new RegExp(r+"$","i"),u='"',h=u+" + ",p=" + "+u;function c(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function y(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function m(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=c(e.labelExpression),t.type="conventional"),t}function f(e){const t=m(e);if(!t)return null;switch(t.type){case"conventional":return v(t.expression);case"arcade":return t.expression}return null}function g(e){const t=m(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=null===e||void 0===e?void 0:e.match(w);return(null===t||void 0===t?void 0:t[1].trim())||null}(t.expression);case"arcade":return M(t.expression)}return null}function v(e){let t;return e?(t=(0,i.HC)(e,(e=>o+'$feature["'+e+'"]'+r)),t=l.test(t)?t.replace(l,""):u+t,t=d.test(t)?t.replace(d,""):t+u,t=t.replaceAll(a,h).replaceAll(s,p)):t='""',t}const w=/^\s*\{([^}]+)\}\s*$/i;const b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,x=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,_=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function M(e){if(!e)return null;let t=b.exec(e)||x.exec(e);return t?t[1]||t[3]:(t=_.exec(e),t?t[2]:null)}},3454:(e,t,n)=>{n.d(t,{j:()=>r});var i=n(31633),o=n(14556);const r={unknown:1,inches:(0,i.oU)(1,"meters","inches"),feet:(0,i.oU)(1,"meters","feet"),"us-feet":(0,i.oU)(1,"meters","us-feet"),yards:(0,i.oU)(1,"meters","yards"),miles:(0,i.oU)(1,"meters","miles"),"nautical-miles":(0,i.oU)(1,"meters","nautical-miles"),millimeters:(0,i.oU)(1,"meters","millimeters"),centimeters:(0,i.oU)(1,"meters","centimeters"),decimeters:(0,i.oU)(1,"meters","decimeters"),meters:(0,i.oU)(1,"meters","meters"),kilometers:(0,i.oU)(1,"meters","kilometers"),"decimal-degrees":1/(0,i.vl)(1,"meters",o.$O.radius)}},9505:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),o=(n(35238),n(46053)),r=(n(81806),n(76460),n(47249),n(85842)),a=n(27544),s=n(13904);let l=class extends a.A{constructor(e){super(e),this.layoutGeometry=null}};(0,i._)([(0,o.MZ)({type:s.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.Entity")],l);const d=l},27544:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(35143),o=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),a=n(12831);let s=class extends a.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],s.prototype,"typeName",void 0),(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],s.prototype,"id",void 0),s=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.GraphNamedObject")],s);const l=s},12831:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(35143),o=n(42553),r=n(46053),a=(n(81806),n(76460),n(47249),n(85842));let s=class extends o.oY{constructor(e){super(e),this.properties=null}};(0,i._)([(0,r.MZ)({json:{write:!0}})],s.prototype,"properties",void 0),s=(0,i._)([(0,a.$)("esri.rest.knowledgeGraph.GraphObject")],s);const l=s},35380:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(35143),o=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),a=n(91967);let s=class extends a.A{constructor(e){super(e),this.openCypherQuery=""}};(0,i._)([(0,o.MZ)()],s.prototype,"openCypherQuery",void 0),s=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.GraphQuery")],s);const l=s;let d=class extends l{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null}};(0,i._)([(0,o.MZ)()],d.prototype,"bindParameters",void 0),(0,i._)([(0,o.MZ)()],d.prototype,"bindGeometryQuantizationParameters",void 0),(0,i._)([(0,o.MZ)()],d.prototype,"outputQuantizationParameters",void 0),(0,i._)([(0,o.MZ)()],d.prototype,"outputSpatialReference",void 0),d=(0,i._)([(0,r.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],d);const u=d},38156:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(35143),o=(n(76460),n(81806),n(47249),n(50076),n(85842)),r=n(12831);let a=class extends r.A{constructor(e){super(e)}};a=(0,i._)([(0,o.$)("esri.rest.knowledgeGraph.ObjectValue")],a);const s=a},68325:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),o=n(42553),r=n(46053),a=(n(81806),n(76460),n(47249),n(85842)),s=n(12831);let l=class extends o.oY{constructor(e){super(e),this.path=null}};(0,i._)([(0,r.MZ)({type:[s.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,i._)([(0,a.$)("esri.rest.knowledgeGraph.Path")],l);const d=l},23908:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),o=(n(35238),n(46053)),r=(n(81806),n(76460),n(47249),n(85842)),a=n(27544),s=n(23701);let l=class extends a.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,i._)([(0,o.MZ)({type:s.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,i._)([(0,r.$)("esri.rest.Relationship.Relationship")],l);const d=l},9708:(e,t,n)=>{n.d(t,{A:()=>p});var i,o=n(35143),r=n(42553),a=n(53084),s=n(46053),l=n(40565),d=n(85842),u=n(17707);let h=i=class extends r.oY{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new i((0,a.o8)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,o._)([(0,s.MZ)({type:[String],json:{write:!0}})],h.prototype,"attachmentTypes",void 0),(0,o._)([(0,s.MZ)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],h.prototype,"attachmentsWhere",void 0),(0,o._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],h.prototype,"cacheHint",void 0),(0,o._)([(0,s.MZ)({type:[String],json:{write:!0}})],h.prototype,"keywords",void 0),(0,o._)([(0,s.MZ)({type:[Number],json:{write:!0}})],h.prototype,"globalIds",void 0),(0,o._)([(0,s.MZ)({json:{write:!0}})],h.prototype,"name",void 0),(0,o._)([(0,s.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],h.prototype,"num",void 0),(0,o._)([(0,s.MZ)({type:[Number],json:{write:!0}})],h.prototype,"objectIds",void 0),(0,o._)([(0,s.MZ)({type:Boolean,json:{default:!1,write:!0}})],h.prototype,"returnMetadata",void 0),(0,o._)([(0,s.MZ)({type:[Number],json:{write:!0}})],h.prototype,"size",void 0),(0,o._)([(0,s.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],h.prototype,"start",void 0),(0,o._)([(0,u.K)("start"),(0,u.K)("num")],h.prototype,"writeStart",null),(0,o._)([(0,s.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],h.prototype,"where",void 0),h=i=(0,o._)([(0,d.$)("esri.rest.support.AttachmentQuery")],h),h.from=(0,l.dp)(h);const p=h},77725:(e,t,n)=>{n.d(t,{A:()=>w});var i,o=n(35143),r=n(35238),a=n(39356),s=n(45802),l=n(42553),d=n(53084),u=n(46053),h=(n(81806),n(76460),n(28379)),p=n(85842),c=n(17707),y=n(13312),m=n(19902),f=n(44135);const g=new s.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let v=i=class extends l.oY{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const n=y.A.fromJSON(t.spatialReference),i=[];for(let r=0;r<e.length;r++){var o;const t=e[r],s=a.A.fromJSON(t),l=null===(o=t.geometry)||void 0===o?void 0:o.spatialReference;null==s.geometry||l||(s.geometry.spatialReference=n);const d=t.aggregateGeometries,u=s.aggregateGeometries;if(d&&null!=u)for(const e in u){const t=u[e],i=d[e],o=null===i||void 0===i?void 0:i.spatialReference;null==t||o||(t.spatialReference=n)}i.push(s)}return i}writeGeometryType(e,t,n,i){if(e)return void g.write(e,t,n,i);const{features:o}=this;if(o)for(const r of o)if(null!=(null===r||void 0===r?void 0:r.geometry))return void g.write(r.geometry.type,t,n,i)}readQueryGeometry(e,t){if(!e)return null;const n=!!e.spatialReference,i=(0,m.rS)(e);return i&&!n&&t.spatialReference&&(i.spatialReference=y.A.fromJSON(t.spatialReference)),i}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:n}=this;if(n)for(const i of n)if(i&&null!=i.geometry&&i.geometry.spatialReference)return void(t.spatialReference=i.geometry.spatialReference.toJSON())}clone(){return new i(this.cloneProperties())}cloneProperties(){return(0,d.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let n=0;n<t.features.length;n++){const i=t.features[n];if(i.geometry){const t=null===e||void 0===e?void 0:e[n];i.geometry=(null===t||void 0===t?void 0:t.toJSON())||i.geometry}}return t}quantize(e){const{scale:[t,n],translate:[i,o]}=e,r=this.features,a=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-i)/t)),(e=>Math.round((o-e)/n)));for(let s=0,l=r.length;s<l;s++)(null===a||void 0===a?void 0:a(r[s].geometry))||(r.splice(s,1),s--,l--);return this.transform=e,this}unquantize(){var e,t;const{geometryType:n,features:i,transform:o}=this;if(!o)return this;const{translate:[r,a],scale:[s,l]}=o;let d=null,u=null;if(this.hasZ&&null!=(null===o||void 0===o||null===(e=o.scale)||void 0===e?void 0:e[2])){const{translate:[,,e],scale:[,,t]}=o;d=n=>n*t+e}if(this.hasM&&null!=(null===o||void 0===o||null===(t=o.scale)||void 0===t?void 0:t[3])){const{translate:[,,,e],scale:[,,,t]}=o;u=n=>null==n?n:n*t+e}const h=this._getHydrationFunction(n,(e=>e*s+r),(e=>a-e*l),d,u);for(const{geometry:p}of i)null!=p&&h&&h(p);return this.transform=null,this}_quantizePoints(e,t,n){let i,o;const r=[];for(let a=0,s=e.length;a<s;a++){const s=e[a];if(a>0){const e=t(s[0]),a=n(s[1]);e===i&&a===o||(r.push([e-i,a-o]),i=e,o=a)}else i=t(s[0]),o=n(s[1]),r.push([i,o])}return r.length>0?r:null}_getQuantizationFunction(e,t,n){return"point"===e?e=>(e.x=t(e.x),e.y=n(e.y),e):"polyline"===e||"polygon"===e?e=>{const i=(0,m.Bi)(e)?e.rings:e.paths,o=[];for(let r=0,a=i.length;r<a;r++){const e=i[r],a=this._quantizePoints(e,t,n);a&&o.push(a)}return o.length>0?((0,m.Bi)(e)?e.rings=o:e.paths=o,e):null}:"multipoint"===e?e=>{const i=this._quantizePoints(e.points,t,n);return i&&i.length>0?(e.points=i,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,n,i,o){return"point"===e?e=>{e.x=t(e.x),e.y=n(e.y),i&&(e.z=i(e.z))}:"polyline"===e||"polygon"===e?e=>{const r=(0,m.Bi)(e)?e.rings:e.paths;let a,s;for(let i=0,o=r.length;i<o;i++){const e=r[i];for(let i=0,o=e.length;i<o;i++){const o=e[i];i>0?(a+=o[0],s+=o[1]):(a=o[0],s=o[1]),o[0]=t(a),o[1]=n(s)}}if(i&&o)for(let t=0,n=r.length;t<n;t++){const e=r[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=i(n[2]),n[3]=o(n[3])}}else if(i)for(let t=0,n=r.length;t<n;t++){const e=r[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=i(n[2])}}else if(o)for(let t=0,n=r.length;t<n;t++){const e=r[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=o(n[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=n(e.ymin),e.xmax=t(e.xmax),e.ymax=n(e.ymax),i&&null!=e.zmax&&null!=e.zmin&&(e.zmax=i(e.zmax),e.zmin=i(e.zmin)),o&&null!=e.mmax&&null!=e.mmin&&(e.mmax=o(e.mmax),e.mmin=o(e.mmin))}:"multipoint"===e?e=>{const r=e.points;let a,s;for(let i=0,o=r.length;i<o;i++){const e=r[i];i>0?(a+=e[0],s+=e[1]):(a=e[0],s=e[1]),e[0]=t(a),e[1]=n(s)}if(i&&o)for(let t=0,n=r.length;t<n;t++){const e=r[t];e[2]=i(e[2]),e[3]=o(e[3])}else if(i)for(let t=0,n=r.length;t<n;t++){const e=r[t];e[2]=i(e[2])}else if(o)for(let t=0,n=r.length;t<n;t++){const e=r[t];e[2]=o(e[2])}}:null}};(0,o._)([(0,u.MZ)({type:String,json:{write:!0}})],v.prototype,"displayFieldName",void 0),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"exceededTransferLimit",void 0),(0,o._)([(0,u.MZ)({type:[a.A],json:{write:!0}})],v.prototype,"features",void 0),(0,o._)([(0,h.w)("features")],v.prototype,"readFeatures",null),(0,o._)([(0,u.MZ)({type:[f.A],json:{write:!0}})],v.prototype,"fields",void 0),(0,o._)([(0,u.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],v.prototype,"geometryType",void 0),(0,o._)([(0,c.K)("geometryType")],v.prototype,"writeGeometryType",null),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasM",void 0),(0,o._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasZ",void 0),(0,o._)([(0,u.MZ)({types:r.yR,json:{write:!0}})],v.prototype,"queryGeometry",void 0),(0,o._)([(0,h.w)("queryGeometry")],v.prototype,"readQueryGeometry",null),(0,o._)([(0,u.MZ)({type:y.A,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,o._)([(0,c.K)("spatialReference")],v.prototype,"writeSpatialReference",null),(0,o._)([(0,u.MZ)({json:{write:!0}})],v.prototype,"transform",void 0),v=i=(0,o._)([(0,p.$)("esri.rest.support.FeatureSet")],v),v.prototype.toJSON.isDefaultToJSON=!0;const w=v},30973:(e,t,n)=>{n.d(t,{tn:()=>d});var i=n(16868),o=n(53430),r=n(75900),a=(n(56362),n(87015),n(81940),n(6929)),s=(n(7198),n(93616),n(53539),n(40585)),l=n(17542);function d(e,t){let{displayField:n,editFieldsInfo:s,fields:l,objectIdField:d,title:u}=e;if(!l)return null;const h=p({editFieldsInfo:s,fields:l,objectIdField:d},t);if(!h.length)return null;const c=function(e){const t=(0,o.mB)(e),{titleBase:n}=e;return t?"".concat(n,": {").concat(t.trim(),"}"):null!==n&&void 0!==n?n:""}({titleBase:u,fields:l,displayField:n}),y=[new a.A,new r.A];return new i.A({title:c,content:y,fieldInfos:h})}const u=(e,t)=>t.visibleFieldNames?t.visibleFieldNames.has(e.name):(0,o.Bz)(e,t);function h(e,t){return"oid"===e.type?-1:"oid"===t.type?1:y(e)?-1:y(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function p(e,t){var n;const i=null===t||void 0===t?void 0:t.visibleFieldNames;return function(e,t){const n=e;return t&&(e=e.filter((e=>!t.includes(e.type)))),e===n&&(e=e.slice()),e.sort(h),e}(null!==(n=e.fields)&&void 0!==n?n:[],(null===t||void 0===t?void 0:t.ignoreFieldTypes)||m).map((t=>new s.A({fieldName:t.name,isEditable:(0,o.R$)(t,e),label:t.alias,format:c(t),visible:u(t,{...e,visibleFieldNames:i})})))}function c(e){switch(e.type){case"small-integer":case"integer":case"single":return new l.A({digitSeparator:!0,places:0});case"double":return new l.A({digitSeparator:!0,places:2});case"string":return(0,o.JL)(e.name)?new l.A({digitSeparator:!0,places:0}):null;default:return null}}function y(e){return"name"===(e.name&&e.name.toLowerCase())||"name"===(e.alias&&e.alias.toLowerCase())}const m=["geometry","blob","raster","guid","xml"]},731:(e,t,n)=>{n.d(t,{A:()=>b});var i,o=n(35143),r=n(45802),a=n(42553),s=n(30726),l=n(46053),d=(n(81806),n(76460),n(47249),n(28379)),u=n(85842),h=n(17707),p=n(53430);let c=i=class extends a.oY{constructor(e){super(e)}async collectRequiredFields(e,t){return(0,p.Dx)(e,t,this.expression)}clone(){return new i({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};(0,o._)([(0,l.MZ)({type:String,json:{write:!0}})],c.prototype,"expression",void 0),(0,o._)([(0,l.MZ)({type:String,json:{write:!0}})],c.prototype,"title",void 0),c=i=(0,o._)([(0,u.$)("esri.layers.support.FeatureExpressionInfo")],c);const y=c;var m,f=n(59097);const g=(0,r.O)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),v=new r.J({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let w=m=class extends a.oY{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,t,n,i){t[n]=e.write({},i),"0"===e.expression&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):null!=e||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new m({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&(0,s.CM)(this.featureExpressionInfo,e.featureExpressionInfo)}};(0,o._)([(0,l.MZ)({type:y,json:{write:!0}})],w.prototype,"featureExpressionInfo",void 0),(0,o._)([(0,d.w)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],w.prototype,"readFeatureExpressionInfo",null),(0,o._)([(0,h.K)("featureExpressionInfo",{featureExpressionInfo:{type:y},"featureExpression.value":{type:[0]}})],w.prototype,"writeFeatureExpressionInfo",null),(0,o._)([(0,l.MZ)({type:g.apiValues,nonNullable:!0,json:{type:g.jsonValues,read:g.read,write:{writer:g.write,isRequired:!0}}})],w.prototype,"mode",null),(0,o._)([(0,l.MZ)({type:Number,json:{write:!0}})],w.prototype,"offset",void 0),(0,o._)([(0,l.MZ)({type:f.KQ,json:{type:String,read:v.read,write:v.write}})],w.prototype,"unit",null),w=m=(0,o._)([(0,u.$)("esri.layers.support.ElevationInfo")],w);const b=w},84202:(e,t,n)=>{n.d(t,{A7:()=>d,Cx:()=>u,Hk:()=>h,JJ:()=>y,UK:()=>l,jM:()=>p,x3:()=>c});n(81806);var i=n(86875),o=n(7246),r=n(76940),a=n(86659),s=n(44460);const l=r.A.fromJSON(s.Cb),d=o.A.fromJSON(s.yM),u=i.A.fromJSON(s.WR),h=a.A.fromJSON(s.JZ);const p=r.A.fromJSON(s.nC),c=o.A.fromJSON(s.HW),y=i.A.fromJSON(s.b6)},44460:(e,t,n)=>{n.d(t,{Cb:()=>o,HW:()=>d,JZ:()=>s,WR:()=>a,b6:()=>u,nC:()=>l,yM:()=>r});const i=[252,146,31,255],o={type:"esriSMS",style:"esriSMSCircle",size:6,color:i,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},r={type:"esriSLS",style:"esriSLSSolid",width:.75,color:i},a={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},s={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},d={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},u={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},59097:(e,t,n)=>{n.d(t,{Ao:()=>o,KQ:()=>r});var i=n(3454);function o(e){return 1/(i.j[e]||1)}const r=function(){const e=Object.keys(i.j);return e.sort(),e}()}}]);
//# sourceMappingURL=1111.c840a26a.chunk.js.map