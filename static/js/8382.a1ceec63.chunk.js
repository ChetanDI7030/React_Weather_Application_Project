"use strict";(self.webpackChunkweather_app=self.webpackChunkweather_app||[]).push([[8382],{80979:(e,t,i)=>{i.d(t,{K:()=>r});const r=["operational-layers","basemap","ground"]},1420:(e,t,i)=>{i.d(t,{g:()=>c});var r=i(35143),s=i(91967),n=i(34154),a=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),l=i(68002),p=i(55053),h=i(46530),u=i(65419);const d={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let c=class extends s.A{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const t=(0,h.f)(this.floors,e);return e.toExportImageJSON(t)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&(0,u.Sk)(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.allSublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("sublayer-update",(e=>this.notifyChange(d[e.propertyName])))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map((e=>e.id)).join(","):"show:-1":null}get layerDefs(){var e;const t=!(null===(e=this.floors)||void 0===e||!e.length),i=this.visibleSublayers.filter((e=>null!=e.definitionExpression||t&&null!=e.floorInfo));return i.length?JSON.stringify(i.reduce(((e,t)=>{const i=(0,h.f)(this.floors,t),r=(0,n.m)(i,t.definitionExpression);return null!=r&&(e[t.id]=r),e}),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const t=this.layer.sublayers,i=this.scale,r=t=>{t.visible&&(0===i||(0,l.zx)(i,t.minScale,t.maxScale))&&(t.sublayers?t.sublayers.forEach(r):e.unshift(t))};t&&t.forEach(r);const s=this._get("visibleSublayers");return!s||s.length!==e.length||s.some(((t,i)=>e[i]!==t))?e:s}toJSON(){const e=this.layer;let t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t={...t,layers:this.layers,layerDefs:this.layerDefs},t}};(0,r._)([(0,a.MZ)({readOnly:!0})],c.prototype,"dynamicLayers",null),(0,r._)([(0,a.MZ)()],c.prototype,"floors",void 0),(0,r._)([(0,a.MZ)({readOnly:!0})],c.prototype,"hasDynamicLayers",null),(0,r._)([(0,a.MZ)()],c.prototype,"layer",null),(0,r._)([(0,a.MZ)({readOnly:!0})],c.prototype,"layers",null),(0,r._)([(0,a.MZ)({readOnly:!0})],c.prototype,"layerDefs",null),(0,r._)([(0,a.MZ)({type:Number})],c.prototype,"scale",void 0),(0,r._)([(0,a.MZ)(p.ui)],c.prototype,"timeExtent",void 0),(0,r._)([(0,a.MZ)({readOnly:!0})],c.prototype,"version",null),(0,r._)([(0,a.MZ)({readOnly:!0})],c.prototype,"visibleSublayers",null),c=(0,r._)([(0,o.$)("esri.layers.mixins.ExportImageParameters")],c)},55053:(e,t,i)=>{i.d(t,{ui:()=>_,Yj:()=>g,id:()=>S,kF:()=>c,fV:()=>m,C1:()=>I,hG:()=>E,hn:()=>M,ke:()=>w,Ih:()=>x,M6:()=>d,Qo:()=>f,Fm:()=>b,PY:()=>u,OZ:()=>y});var r=i(82111),s=i(80979),n=i(76797),a=i(13312),o=i(79453),l=(i(18690),i(53084),i(18288));var p=i(731),h=i(2183);const u={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:s.K}}},d={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,i){t[i]=!e}}}},c={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:s.K}}},y={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:o.w}}},m={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:s.K}}},g={value:null,type:p.A,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:s.K}}};function f(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const v={write:{enabled:!0,layerContainerTypes:s.K},read:!0},w={type:Number,json:{origins:{"web-document":v,"portal-item":{write:!0}}}},x={...w,json:{...w.json,origins:{"web-document":{...v,write:{enabled:!0,layerContainerTypes:s.K,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,i)=>{var r;return i&&"service"!==i.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?null!==(r=t.layerDefinition)&&void 0!==r&&r.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?(0,h.D)(t.layerDefinition.drawingInfo.transparency):void 0:(0,h.D)(t.drawingInfo.transparency)}}}},_={type:r.A,readOnly:!0,get(){var e,t,i;const s=null!=(null===(e=this.layer)||void 0===e?void 0:e.timeInfo)?this.layer:null!=(null===(t=this.i3slayer)||void 0===t?void 0:t.timeInfo)?this.i3slayer:null;if(null==s)return null;const{datesInUnknownTimezone:n,timeOffset:a,useViewTime:o}=s,p=null===(i=this.view)||void 0===i?void 0:i.timeExtent;let h=s.timeExtent;n&&(h=function(e){if(!e)return e;const{start:t,end:i}=e;return new r.A({start:null!=t?(0,l.S1)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,l.S1)(i,i.getTimezoneOffset(),"minutes"):i})}(h));let u=o?p&&h?p.intersection(h):p||h:h;if(!u||u.isEmpty||u.isAllTime)return u;a&&(u=u.offset(-a.value,a.unit)),n&&(u=function(e){if(!e)return e;const{start:t,end:i}=e;return new r.A({start:null!=t?(0,l.S1)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,l.S1)(i,-i.getTimezoneOffset(),"minutes"):i})}(u));const d=this._get("timeExtent");return u.equals(d)?d:u}},b={type:n.A,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const i=n.A.fromJSON(e);return null!=t.spatialReference&&"object"==typeof t.spatialReference&&(i.spatialReference=a.A.fromJSON(t.spatialReference)),i}}}},read:!1}},S={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},M={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:s.K}}},name:"layerDefinition.minScale",write:!0}},E={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:s.K}}},name:"layerDefinition.maxScale",write:!0}},I={json:{write:{ignoreOrigin:!0,layerContainerTypes:s.K},origins:{"web-map":{read:!1,write:!1}}}}},731:(e,t,i)=>{i.d(t,{A:()=>x});var r,s=i(35143),n=i(45802),a=i(42553),o=i(30726),l=i(46053),p=(i(81806),i(76460),i(47249),i(28379)),h=i(85842),u=i(17707),d=i(53430);let c=r=class extends a.oY{constructor(e){super(e)}async collectRequiredFields(e,t){return(0,d.Dx)(e,t,this.expression)}clone(){return new r({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],c.prototype,"expression",void 0),(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],c.prototype,"title",void 0),c=r=(0,s._)([(0,h.$)("esri.layers.support.FeatureExpressionInfo")],c);const y=c;var m,g=i(59097);const f=(0,n.O)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),v=new n.J({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let w=m=class extends a.oY{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,t,i,r){t[i]=e.write({},r),"0"===e.expression&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):null!=e||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new m({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&(0,o.CM)(this.featureExpressionInfo,e.featureExpressionInfo)}};(0,s._)([(0,l.MZ)({type:y,json:{write:!0}})],w.prototype,"featureExpressionInfo",void 0),(0,s._)([(0,p.w)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],w.prototype,"readFeatureExpressionInfo",null),(0,s._)([(0,u.K)("featureExpressionInfo",{featureExpressionInfo:{type:y},"featureExpression.value":{type:[0]}})],w.prototype,"writeFeatureExpressionInfo",null),(0,s._)([(0,l.MZ)({type:f.apiValues,nonNullable:!0,json:{type:f.jsonValues,read:f.read,write:{writer:f.write,isRequired:!0}}})],w.prototype,"mode",null),(0,s._)([(0,l.MZ)({type:Number,json:{write:!0}})],w.prototype,"offset",void 0),(0,s._)([(0,l.MZ)({type:g.KQ,json:{type:String,read:v.read,write:v.write}})],w.prototype,"unit",null),w=m=(0,s._)([(0,h.$)("esri.layers.support.ElevationInfo")],w);const x=w},59097:(e,t,i)=>{i.d(t,{Ao:()=>s,KQ:()=>n});var r=i(3454);function s(e){return 1/(r.j[e]||1)}const n=function(){const e=Object.keys(r.j);return e.sort(),e}()},14509:(e,t,i)=>{i.d(t,{l:()=>a});var r=i(69139),s=i(61551),n=i(36201);class a extends n.A{constructor(){super(...arguments),this._hasCrossfade=!1}get requiresDedicatedFBO(){return super.requiresDedicatedFBO||this._hasCrossfade}beforeRender(e){super.beforeRender(e),this._manageFade()}prepareRenderPasses(e){const t=e.registerRenderPass({name:"bitmap",brushes:[r.d.bitmap],target:()=>this.children,drawPhase:s.S5.MAP});return[...super.prepareRenderPasses(e),t]}_manageFade(){this.children.reduce(((e,t)=>e+(t.inFadeTransition?1:0)),0)>=2?(this.children.forEach((e=>e.blendFunction="additive")),this._hasCrossfade=!0):(this.children.forEach((e=>e.blendFunction="standard")),this._hasCrossfade=!1)}}},18382:(e,t,i)=>{i.r(t),i.d(t,{default:()=>S});var r=i(35143),s=i(76460),n=i(50346),a=i(68134),o=i(46053),l=(i(81806),i(47249),i(85842)),p=i(64519),h=i(14509),u=i(90104),d=i(45992),c=i(70822),y=i(4176),m=i(91196),g=i(55053),f=i(1420);const v=e=>{let t=class extends e{initialize(){this.exportImageParameters=new f.g({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){var e,t;return null!==(e=null===(t=this.view)||void 0===t?void 0:t.floors)&&void 0!==e?e:null}get exportImageVersion(){var e;return null!==(e=this.exportImageParameters)&&void 0!==e&&e.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}canResume(){var e;return!!super.canResume()&&!(null!==(e=this.timeExtent)&&void 0!==e&&e.isEmpty)}};return(0,r._)([(0,o.MZ)()],t.prototype,"exportImageParameters",void 0),(0,r._)([(0,o.MZ)({readOnly:!0})],t.prototype,"floors",null),(0,r._)([(0,o.MZ)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,r._)([(0,o.MZ)()],t.prototype,"layer",void 0),(0,r._)([(0,o.MZ)()],t.prototype,"suspended",void 0),(0,r._)([(0,o.MZ)(g.ui)],t.prototype,"timeExtent",void 0),t=(0,r._)([(0,l.$)("esri.views.layers.MapImageLayerView")],t),t};var w=i(771),x=i(93080),_=i(55754);let b=class extends(v((0,w.A)((0,u.e)(m.A)))){constructor(){super(...arguments),this._highlightGraphics=new p.Y,this._updateHash=""}fetchPopupFeaturesAtLocation(e,t){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(e,t)}update(e){const t="".concat(this.exportImageVersion,"/").concat(e.state.id,"/").concat(e.pixelRatio,"/").concat(e.stationary);this._updateHash!==t&&(this._updateHash=t,this.strategy.update(e).catch((e=>{(0,n.zf)(e)||s.A.getLogger(this).error(e)})),e.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(e.state.resolution)),this._highlightView.processUpdate(e)}attach(){const{imageMaxWidth:e,imageMaxHeight:t,version:i}=this.layer,r=i>=10.3,s=i>=10;this._bitmapContainer=new h.l,this.container.addChild(this._bitmapContainer),this._highlightView=new d.A({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new c.A(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new x.Uh({createFetchPopupFeaturesQueryGeometry:(e,t)=>(0,_.V)(e,t,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(e,t)=>{this._highlightView.graphicUpdateHandler({graphic:e,property:t})},layerView:this,updatingHandles:this._updatingHandles}),this.strategy=new y.A({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:e,imageMaxHeight:t,imageRotationSupported:r,imageNormalizationSupported:s,hidpi:!0}),this.addAttachHandles((0,a.wB)((()=>this.exportImageVersion),(()=>this.requestUpdate()))),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(e){return this.layer.serviceSupportsSpatialReference(e)}async doRefresh(){this._updateHash="",this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,i,r){return this.layer.fetchImage(e,t,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}fetchImageBitmap(e,t,i,r){return this.layer.fetchImageBitmap(e,t,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}highlight(e){return this._popupHighlightHelper.highlight(e)}};(0,r._)([(0,o.MZ)()],b.prototype,"strategy",void 0),(0,r._)([(0,o.MZ)()],b.prototype,"updating",void 0),b=(0,r._)([(0,l.$)("esri.views.2d.layers.MapImageLayerView2D")],b);const S=b},4176:(e,t,i)=>{i.d(t,{A:()=>I});var r=i(35143),s=i(91967),n=(i(81806),i(50346)),a=i(46053),o=(i(76460),i(47249),i(85842)),l=i(2413),p=i(80963),h=i(88235);const u=Math.PI/180;function d(e){return e*u}function c(e,t){const i=d(t.rotation),r=Math.abs(Math.cos(i)),s=Math.abs(Math.sin(i)),[n,a]=t.size;return e[0]=Math.round(a*s+n*r),e[1]=Math.round(a*r+n*s),e}var y=i(16060),m=i(40181),g=i(93453);const f=(0,l.vt)(),v=[0,0],w=new g.A(0,0,0,0),x=2048,_=2048,b=!1,S=!1,M=!1;let E=class extends s.A{constructor(e){super(e),this._imagePromise=null,this.bitmaps=[],this.hidpi=M,this.imageMaxWidth=x,this.imageMaxHeight=_,this.imageRotationSupported=b,this.imageNormalizationSupported=S,this.update=(0,n.sg)((async(e,t)=>{var i,r;if((0,n.Te)(t),!e.stationary||this.destroyed)return;const s=e.state,a=(0,p.Vp)(s.spatialReference),o=this.hidpi?e.pixelRatio:1,l=this.imageNormalizationSupported&&s.worldScreenWidth&&s.worldScreenWidth<s.size[0],h=null!==(i=this.imageMaxWidth)&&void 0!==i?i:0,u=null!==(r=this.imageMaxHeight)&&void 0!==r?r:0;l?(v[0]=s.worldScreenWidth,v[1]=s.size[1]):this.imageRotationSupported?(v[0]=s.size[0],v[1]=s.size[1]):c(v,s);const d=Math.floor(v[0]*o)>h||Math.floor(v[1]*o)>u,y=a&&(s.extent.xmin<a.valid[0]||s.extent.xmax>a.valid[1]),m=!this.imageNormalizationSupported&&y,g=!d&&!m,f=this.imageRotationSupported?s.rotation:0,x=this.container.children.slice();if(g){const e=l?s.paddedViewState.center:s.center;this._imagePromise&&console.error("Image promise was not defined!"),this._imagePromise=this._singleExport(s,v,e,s.resolution,f,o,t)}else{let e=Math.min(h,u);m&&(e=Math.min(s.worldScreenWidth,e)),this._imagePromise=this._tiledExport(s,e,o,t)}try{var _;const e=null!==(_=await this._imagePromise)&&void 0!==_?_:[];(0,n.Te)(t);const i=[];if(this._imagePromise=null,this.destroyed)return;this.bitmaps=e;for(const t of x)e.includes(t)||i.push(t.fadeOut().then((()=>{t.remove(),t.destroy()})));for(const t of e)i.push(t.fadeIn());await Promise.all(i)}catch(w){this._imagePromise=null,(0,n.QP)(w)}}),5e3),this.updateExports=(0,n.sg)((async e=>{const t=[];for(const i of this.container.children){if(!i.visible||!i.stage)return;t.push(e(i).then((()=>{i.invalidateTexture(),i.requestRender()})))}this._imagePromise=(0,n.Lx)(t).then((()=>this._imagePromise=null)),await this._imagePromise}))}destroy(){this.bitmaps.forEach((e=>e.destroy())),this.bitmaps=[]}get updating(){return!this.destroyed&&null!==this._imagePromise}async _export(e,t,i,r,s,a){const o=await this.fetchSource(e,Math.floor(t*s),Math.floor(i*s),{rotation:r,pixelRatio:s,signal:a});(0,n.Te)(a);const l=new y.mb(null,!0);return l.x=e.xmin,l.y=e.ymax,l.resolution=e.width/t,l.rotation=r,l.pixelRatio=s,l.opacity=0,this.container.addChild(l),await l.setSourceAsync(o,a),(0,n.Te)(a),l}async _singleExport(e,t,i,r,s,n,a){!function(e,t,i,r){const[s,n]=t,[a,o]=r,l=.5*i;e[0]=s-l*a,e[1]=n-l*o,e[2]=s+l*a,e[3]=n+l*o}(f,i,r,t);const o=(0,l.w1)(f,e.spatialReference);return[await this._export(o,t[0],t[1],s,n,a)]}_tiledExport(e,t,i,r){const s=h.A.create({size:t,spatialReference:e.spatialReference,scales:[e.scale]}),n=new m.A(s),a=n.getTileCoverage(e);if(!a)return null;const o=[];return a.forEach(((s,a,p,h)=>{w.set(s,a,p,0),n.getTileBounds(f,w);const u=(0,l.w1)(f,e.spatialReference);o.push(this._export(u,t,t,0,i,r).then((e=>(0!==h&&(w.set(s,a,p,h),n.getTileBounds(f,w),e.x=f[0],e.y=f[3]),e))))})),Promise.all(o)}};(0,r._)([(0,a.MZ)()],E.prototype,"_imagePromise",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"bitmaps",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"container",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"fetchSource",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"hidpi",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"imageMaxWidth",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"imageMaxHeight",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"imageRotationSupported",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"imageNormalizationSupported",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"requestUpdate",void 0),(0,r._)([(0,a.MZ)()],E.prototype,"updating",null),E=(0,r._)([(0,o.$)("esri.views.2d.layers.support.ExportStrategy")],E);const I=E}}]);
//# sourceMappingURL=8382.a1ceec63.chunk.js.map